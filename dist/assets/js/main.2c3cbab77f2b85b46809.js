"use strict";(self.webpackChunkrush_dashboard=self.webpackChunkrush_dashboard||[]).push([[792],{3320:(e,t,a)=>{var s=a(6540),n=a(5338),i=a(7796),r=a(3688),l=a(8868),o=a(888);const c=["skipAuthErrorHandling","headers","credentials"];var d;function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach(function(t){h(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function h(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const p=(()=>{try{return{}}catch(e){return"undefined"!=typeof process&&process.env?{MODE:"production",VITE_API_BASE_URL:""}:{}}})(),x=p.MODE||"development",v=null!==(d=p.VITE_API_BASE_URL)&&void 0!==d?d:"https://rush.nicolaruotolo.it/api",j="production"===x,g=new Set(["token","authorization","password","sessiontoken","session_token","auth"]),f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new WeakSet,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return e.toISOString();if(e instanceof Error)return{name:e.name,message:e.message,stack:j?void 0:e.stack};if(t.has(e))return"[Circular]";if(a>3)return"[Object]";t.add(e);try{return Array.isArray(e)?e.map(e=>f(e,t,a+1)):Object.entries(e).reduce((e,s)=>{let[n,i]=s;const r=String(n).toLowerCase();return g.has(r)?(e[n]="[REDACTED]",e):(e[n]=f(i,t,a+1),e)},{})}finally{t.delete(e)}},b=e=>function(){if(j)return;for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];const n=a.map(e=>f(e));e(...n)},N=b(console.log.bind(console)),A=b(console.error.bind(console)),y=b(console.warn.bind(console)),w="rush-dashboard:api-session";class k extends Error{constructor(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e),this.name="ApiError",this.statusCode=t,this.details=a}}const C=new class{constructor(){this.token=null,this.currentUser=null,this.expiresAt=null,this.sessionActive=!1,this.baseURL=v,N("ðŸ”— API URL configurata: ".concat(this.baseURL)),N("ðŸŒ Environment: ".concat(x)),this.loadStoredSession()}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a="".concat(this.baseURL,"/").concat(e.replace(/^\//,"")),{skipAuthErrorHandling:s=!1,headers:n={},credentials:i}=t,r=function(e,t){if(null==e)return{};var a,s,n=function(e,t){if(null==e)return{};var a={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(-1!==t.indexOf(s))continue;a[s]=e[s]}return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],-1===t.indexOf(a)&&{}.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(t,c),l=r.body instanceof FormData,o=m(m({},this.getAuthHeaders()),n);void 0===r.body||null===r.body||l||"Content-Type"in o||(o["Content-Type"]="application/json");let d=i;if(void 0===d&&"undefined"!=typeof window)try{new URL(this.baseURL,window.location.href).origin===window.location.origin&&(d="include")}catch(e){y("Impossibile determinare l'origin dell'API:",e)}const u=m(m({},r),{},{headers:o},void 0!==d?{credentials:d}:{});try{N("ðŸš€ API Request: ".concat(u.method||"GET"," ").concat(a));const t=await fetch(a,u);N("ðŸ“¡ Response Status: ".concat(t.status," ").concat(t.statusText));const n=await t.json();if(!t.ok)throw 401===t.status&&(s?this.clearSession():this.handleAuthError()),new k(n.error||"Errore della richiesta",t.status,n);return N("âœ… API Response: ".concat(e),n),n}catch(t){if(A("âŒ API Error: ".concat(e),t),t instanceof k)throw t;if(t instanceof TypeError&&t.message.includes("fetch"))throw A("ðŸŒ Network Error: Impossibile raggiungere ".concat(a)),A("ðŸ“‹ Possibili cause:"),A("   - Server non raggiungibile"),A("   - Problemi CORS"),A("   - Connessione internet assente"),new k("Errore di connessione. Controlla la connessione internet.",0);throw new k("Errore di comunicazione con il server",0,t)}}handleAuthError(){let{shouldReload:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y("ðŸ”’ Token non valido, logout automatico"),this.clearSession(),e&&window.location.reload()}getAuthHeaders(){return this.token?{Authorization:"Bearer ".concat(this.token)}:{}}clearSession(){if(this.token=null,this.currentUser=null,this.expiresAt=null,this.sessionActive=!1,"undefined"!=typeof window&&window.localStorage)try{window.localStorage.removeItem(w)}catch(e){y("Impossibile rimuovere la sessione dal localStorage:",e)}}setToken(e){this.token=e||null,this.token&&this.saveSessionToStorage()}saveSessionToStorage(){if("undefined"!=typeof window&&window.localStorage)try{const e={token:this.token,currentUser:this.currentUser,expiresAt:this.expiresAt,sessionActive:this.sessionActive};window.localStorage.setItem(w,JSON.stringify(e))}catch(e){y("Impossibile salvare la sessione nel localStorage:",e)}}loadStoredSession(){if("undefined"!=typeof window&&window.localStorage)try{const e=window.localStorage.getItem(w);if(!e)return;const t=JSON.parse(e);if(null!=t&&t.expiresAt&&new Date(t.expiresAt)<=new Date)return void this.clearSession();this.token=(null==t?void 0:t.token)||null,this.currentUser=(null==t?void 0:t.currentUser)||null,this.expiresAt=(null==t?void 0:t.expiresAt)||null,this.sessionActive=Boolean((null==t?void 0:t.sessionActive)&&(null==t?void 0:t.token))}catch(e){y("Impossibile caricare la sessione dal localStorage:",e);try{window.localStorage.removeItem(w)}catch(e){y("Impossibile ripulire la sessione corrotta dal localStorage:",e)}}}async login(e,t){try{var a;N("ðŸ” Tentativo login per: ".concat(e));const s=await this.makeRequest("login",{method:"POST",body:JSON.stringify({username:e,password:t})});if(!s.success)throw new Error(s.error||"Login fallito");return this.setToken(s.token||null),this.currentUser=s.user||null,this.expiresAt=s.expires_at||null,this.sessionActive=!0,this.saveSessionToStorage(),N("âœ… Login successful for:",(null===(a=s.user)||void 0===a?void 0:a.username)||"utente sconosciuto"),{success:!0,user:this.currentUser,token:this.token}}catch(e){return A("âŒ Login failed:",e),{success:!1,error:e.message}}}async logout(){try{await this.makeRequest("logout",{method:"POST",skipAuthErrorHandling:!0})}catch(e){y("Errore durante logout:",e)}finally{this.clearSession()}}isAuthenticated(){return(this.token||!!this.sessionActive)&&(!(this.expiresAt&&new Date(this.expiresAt)<=new Date)||(this.clearSession(),!1))}getCurrentUser(){return this.currentUser}async restoreSession(){try{const e=await this.makeRequest("profile",{skipAuthErrorHandling:!0});if(!e)return this.clearSession(),{success:!1};const t=e.user||e.profile||e.data||null;return t?(this.currentUser=t,this.sessionActive=!0,e.token&&this.setToken(e.token),e.expires_at&&(this.expiresAt=e.expires_at),this.saveSessionToStorage(),{success:!0,user:t}):(this.clearSession(),{success:!1})}catch(e){if(e instanceof k&&401===e.statusCode)return this.clearSession(),{success:!1};throw e}}async changePassword(e,t){return await this.makeRequest("change-password",{method:"POST",body:JSON.stringify({current_password:e,new_password:t})})}async loadFiles(){try{var e;const t=await this.makeRequest("uploads");return N("ðŸ“ Files loaded from server:",(null===(e=t.files)||void 0===e?void 0:e.length)||0),t.files||[]}catch(e){throw A("âŒ Error loading files:",e),e}}async getFileData(e){try{const t=await this.makeRequest("file-data/".concat(e));return N("ðŸ“Š File data loaded for ".concat(e,":"),t),t}catch(t){throw A("âŒ Error loading file data for ".concat(e,":"),t),t}}async saveFile(e){try{N("ðŸ’¾ Saving file:",e.name,e.date);const t=await this.makeRequest("upload",{method:"POST",body:JSON.stringify({fileData:e})});return N("âœ… File saved successfully:",t),t}catch(e){throw A("âŒ Error saving file:",e),e}}async deleteFile(e){try{N("ðŸ—‘ï¸ Deleting file: ".concat(e));const t=await this.makeRequest("uploads/".concat(e),{method:"DELETE"});return N("âœ… File deleted successfully:",t),t}catch(t){throw A("âŒ Error deleting file ".concat(e,":"),t),t}}async uploadFile(e,t){try{const a=new FormData;a.append("file",e),a.append("data",JSON.stringify(t)),N("ðŸ“¤ Uploading file:",e.name);const s=await this.makeRequest("upload-file",{method:"POST",body:a,headers:m({},this.getAuthHeaders())});return N("âœ… File uploaded successfully:",s),s}catch(e){throw A("âŒ Error uploading file:",e),e}}async getDashboardStats(){try{const e=await this.makeRequest("dashboard/stats");return N("ðŸ“ˆ Dashboard stats loaded:",e),e}catch(e){throw A("âŒ Error loading dashboard stats:",e),e}}async getStatsForPeriod(e,t){try{const a=await this.makeRequest("stats/period?start=".concat(e,"&end=").concat(t));return N("ðŸ“Š Period stats loaded (".concat(e," - ").concat(t,"):"),a),a}catch(e){throw A("âŒ Error loading period stats:",e),e}}async getSMRanking(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=e?"sm-ranking/".concat(e):"sm-ranking",a=await this.makeRequest(t);return N("ðŸ… SM ranking loaded:",a),a}catch(e){throw A("âŒ Error loading SM ranking:",e),e}}async getAgentsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=e?"agents/".concat(e):"agents",a=await this.makeRequest(t);return N("ðŸ‘¥ Agents details loaded:",a),a}catch(e){throw A("âŒ Error loading agents details:",e),e}}async getProductsAnalysis(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=e?"products/".concat(e):"products",a=await this.makeRequest(t);return N("ðŸ“¦ Products analysis loaded:",a),a}catch(e){throw A("âŒ Error loading products analysis:",e),e}}async getNewClientsData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=e?"new-clients/".concat(e):"new-clients",a=await this.makeRequest(t);return N("ðŸ†• New clients data loaded:",a),a}catch(e){throw A("âŒ Error loading new clients data:",e),e}}async getFastwebData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=e?"fastweb/".concat(e):"fastweb",a=await this.makeRequest(t);return N("âš¡ Fastweb data loaded:",a),a}catch(e){throw A("âŒ Error loading Fastweb data:",e),e}}async getUserProfile(){try{const e=await this.makeRequest("profile");return N("ðŸ‘¤ User profile loaded:",e),e}catch(e){throw A("âŒ Error loading user profile:",e),e}}async updateUserProfile(e){try{const t=await this.makeRequest("profile",{method:"PUT",body:JSON.stringify(e)});return N("âœ… User profile updated:",t),t}catch(e){throw A("âŒ Error updating user profile:",e),e}}async healthCheck(){try{const e=await this.makeRequest("health");return N("ðŸ’š API health check passed:",e),e}catch(e){return A("â¤ï¸â€ðŸ©¹ API health check failed:",e),{success:!1,error:e.message}}}async getSystemInfo(){try{const e=await this.makeRequest("system-info");return N("â„¹ï¸ System info loaded:",e),e}catch(e){throw A("âŒ Error loading system info:",e),e}}async cleanup(){try{const e=await this.makeRequest("cleanup",{method:"POST"});return N("ðŸ§¹ System cleanup completed:",e),e}catch(e){throw A("âŒ Error during system cleanup:",e),e}}async exportData(){try{var e;N("ðŸ“¥ Starting data export...");const t=await this.loadFiles(),a={},s=t.map(async e=>{try{const t=await this.getFileData(e.file_date);return{key:e.file_date,value:m({fileInfo:{name:e.file_name,displayDate:e.display_date,uploadDate:e.upload_date,size:e.file_size}},t)}}catch(t){return y("âš ï¸ Errore caricamento file ".concat(e.file_date,":"),t),null}}),n=await Promise.all(s);for(const e of n)e&&(a[e.key]=e.value);const i={exportDate:(new Date).toISOString(),version:"1.0.0",files:a,metadata:{totalFiles:t.length,exportedBy:null===(e=this.getCurrentUser())||void 0===e?void 0:e.username}},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),l=window.URL.createObjectURL(r),o=document.createElement("a");return o.href=l,o.download="rush-dashboard-backup-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(l),N("âœ… Data export completed successfully"),{success:!0,message:"Export completato con successo"}}catch(e){throw A("âŒ Error during data export:",e),e}}async importData(e){try{N("ðŸ“¤ Starting data import...");const t=new FormData;t.append("backup",e);const a=await this.makeRequest("import",{method:"POST",body:t,headers:m({},this.getAuthHeaders())});return N("âœ… Data import completed:",a),a}catch(e){throw A("âŒ Error during data import:",e),e}}async getActivityLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{const a=await this.makeRequest("logs?limit=".concat(e,"&offset=").concat(t));return N("ðŸ“‹ Activity logs loaded:",a),a}catch(e){throw A("âŒ Error loading activity logs:",e),e}}async search(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const a=await this.makeRequest("search",{method:"POST",body:JSON.stringify({query:e,filters:t})});return N("ðŸ” Search completed:",a),a}catch(e){throw A("âŒ Error during search:",e),e}}async getUsers(){const e=await this.makeRequest("users");return e&&Array.isArray(e.users)?e.users:[]}async updateUserRole(e,t){return await this.makeRequest("users/".concat(e,"/role"),{method:"PUT",body:JSON.stringify({role:t})})}async adminUpdateUserPassword(e,t){return await this.makeRequest("users/".concat(e,"/password"),{method:"PUT",body:JSON.stringify({new_password:t})})}async createUser(e){return await this.makeRequest("users",{method:"POST",body:JSON.stringify(e)})}async deleteUser(e){return await this.makeRequest("users/".concat(e),{method:"DELETE"})}async batchOperation(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const s=await this.makeRequest("batch",{method:"POST",body:JSON.stringify({operation:e,fileIds:t,options:a})});return N("âœ… Batch operation '".concat(e,"' completed:"),s),s}catch(t){throw A("âŒ Error during batch operation '".concat(e,"':"),t),t}}};var S=a(3959);const R={AGENTE:{patterns:["nome agente","agente","nome","cognome agente","consulente"],required:!0,description:"Nome/Cognome dell'agente"},SM:{patterns:["sm","sales manager","coordinatore","coord","manager"],required:!0,description:"Sales Manager / Coordinatore"},DISTRETTO:{patterns:["distretto"],required:!1,description:"Distretto di appartenenza"},FATTURATO_RUSH:{patterns:["fatturato rush","rush fatturato","fat rush"],required:!0,description:"Fatturato Rush dell'agente"},FATTURATO_COMPLESSIVO:{patterns:["fatturato complessivo","fatturato totale","totale fatturato"],required:!0,description:"Fatturato Complessivo dell'agente"},BONUS_RISULTATI:{patterns:["importo totale"],required:!1,description:"Bonus economico per risultati"},SIM_VOCE:{patterns:["sim voce totali","sim voce"],required:!1,description:"Contratti SIM Voce"},SIM_DATI:{patterns:["sim dati totali","sim dati"],required:!1,description:"Contratti SIM Dati"},MNP:{patterns:["sim mnp voce","mnp"],required:!1,description:"Contratti MNP"},EASY_RENT:{patterns:["easy rent"],required:!1,description:"Contratti Easy Rent"},LINK_OU:{patterns:["link ou"],required:!1,description:"Contratti Link OU"},LINK_OA:{patterns:["link oa"],required:!1,description:"Contratti Link OA"},LINK_OA_START:{patterns:["link oa start"],required:!1,description:"Contratti Link OA Start"},INTERNI_OA:{patterns:["interni oa"],required:!1,description:"Contratti Interni OA"},FATTURATO_VOCE:{patterns:["fatturato voce"],required:!1,description:"Fatturato Voce"},FATTURATO_DATI:{patterns:["fatturato dati"],required:!1,description:"Fatturato Dati"},FATTURATO_EASY_RENT:{patterns:["fatturato easy rent"],required:!1,description:"Fatturato Easy Rent"},FATTURATO_OU:{patterns:["fatturato ou"],required:!1,description:"Fatturato OU"},FATTURATO_OA:{patterns:["fatturato oa"],required:!1,description:"Fatturato OA"},FATTURATO_EASY_DEAL:{patterns:["fatturato easy e complex deal"],required:!1,description:"Fatturato Easy & Complex Deal"},FATTURATO_ALTRO:{patterns:["fatturato altro"],required:!1,description:"Fatturato Altro"},FATTURATO_SERVIZI_DIGITALI:{patterns:["fatturato servizi digitali"],required:!1,description:"Fatturato Servizi Digitali"},FATTURATO_CUSTOM:{patterns:["fatturato custom"],required:!1,description:"Fatturato Custom"},SDM:{patterns:["sdm"],required:!1,description:"Contratti SDM"},FATTURATO_SDM:{patterns:["fatturato sdm"],required:!1,description:"Fatturato SDM"},SSC:{patterns:["ssc"],required:!1,description:"Contratti SSC"},FATTURATO_SSC:{patterns:["fatturato ssc"],required:!1,description:"Fatturato SSC"},YOUR_BACKUP:{patterns:["your backup"],required:!1,description:"Contratti Your Backup"},FATTURATO_YOUR_BACKUP:{patterns:["inflow your backup"],required:!1,description:"Fatturato Your Backup"},CLOUD_NAS:{patterns:["cloud nas"],required:!1,description:"Contratti Cloud NAS"},FATTURATO_CLOUD_NAS:{patterns:["inflow cloud nas"],required:!1,description:"Fatturato Cloud NAS"},EASY_GDPR:{patterns:["easy gdpr"],required:!1,description:"Contratti Easy GDPR"},FATTURATO_EASY_GDPR:{patterns:["fatturato easy gdpr"],required:!1,description:"Fatturato Easy GDPR"},MIIA:{patterns:["miia"],required:!1,description:"Contratti MIIA"},FATTURATO_MIIA:{patterns:["inflow miia"],required:!1,description:"Fatturato MIIA"},FATTURATO_NUOVO_CLIENTE:{patterns:["fatturato nuovo cliente"],required:!1,description:"Fatturato Nuovo Cliente"},BSALES_MOBILE:{patterns:["bsales mobile"],required:!1,description:"Contratti Bsales Mobile"},PDA_DIGITALE:{patterns:["pda digitale"],required:!1,description:"Contratti PDA Digitale"},ADSL:{patterns:["adsl","adsl casa","internet casa"],required:!1,description:"Contratti ADSL"},FIBRA:{patterns:["fibra","ftth","fibra ottica","fibra casa"],required:!1,description:"Contratti Fibra"},FIBRA_BUSINESS:{patterns:["fibra business","fibra aziendale","ftth business"],required:!1,description:"Contratti Fibra Business"},NUOVO_CLIENTE:{patterns:["nuovo cliente","nuovi clienti","nc","new customers","clienti nuovi"],required:!1,description:"Nuovi Clienti acquisiti"},STATION:{patterns:["station","tim station","negozi"],required:!1,description:"Contratti via Station"},FASTWEB_ENERGIA:{patterns:["fastweb energia","fw energia","fastweb luce gas"],required:!1,description:"Contratti Fastweb Energia"},TOTALE_PEZZI:{patterns:["totale pezzi","pezzi totali","tot pezzi","pieces"],required:!1,description:"Totale contratti/pezzi"},NUMERO:{patterns:["n.","numero","n","#","id"],required:!1,description:"Numero identificativo"}};function O(e,t,a){const s=function(s){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const i=a[s];if(!i)return"number"===n?0:"";const r="".concat(i).concat(t+1);return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";if(!e||void 0===e.v||null===e.v||""===e.v)return"number"===t?0:"";let a=e.v;if("number"===t){if("number"==typeof a)return a;if("string"==typeof a){a=a.toString().replace(/[â‚¬$.\s]/g,"").replace(",",".");const e=parseFloat(a);return isNaN(e)?0:e}return 0}return"string"===t?a.toString().trim():"number"==typeof a?a:a.toString().trim()}(e[r],n)},n={};return n.nome=s("AGENTE","string"),n.sm=s("SM","string"),n.distretto=s("DISTRETTO","string"),n.fatturatoRush=s("FATTURATO_RUSH","number"),n.bonusRisultati=s("BONUS_RISULTATI","number"),n.fatturato={complessivo:s("FATTURATO_COMPLESSIVO","number")},n.simVoce=s("SIM_VOCE","number"),n.adsl=s("ADSL","number"),n.simDati=s("SIM_DATI","number"),n.fibra=s("FIBRA","number"),n.fibraBusiness=s("FIBRA_BUSINESS","number"),n.fastwebEnergia=s("FASTWEB_ENERGIA","number"),n.nuovoCliente=s("NUOVO_CLIENTE","number"),n.station=s("STATION","number"),n.mnp=s("MNP","number"),n.totalePezzi=s("TOTALE_PEZZI","number"),n.numero=s("NUMERO","string"),n.easyRent=s("EASY_RENT","number"),n.linkOu=s("LINK_OU","number"),n.linkOa=s("LINK_OA","number"),n.linkOaStart=s("LINK_OA_START","number"),n.interniOa=s("INTERNI_OA","number"),n.fatturatoVoce=s("FATTURATO_VOCE","number"),n.fatturatoDati=s("FATTURATO_DATI","number"),n.fatturatoEasyRent=s("FATTURATO_EASY_RENT","number"),n.fatturatoOu=s("FATTURATO_OU","number"),n.fatturatoOa=s("FATTURATO_OA","number"),n.fatturatoEasyDeal=s("FATTURATO_EASY_DEAL","number"),n.fatturatoAltro=s("FATTURATO_ALTRO","number"),n.fatturatoServiziDigitali=s("FATTURATO_SERVIZI_DIGITALI","number"),n.fatturatoCustom=s("FATTURATO_CUSTOM","number"),n.sdm=s("SDM","number"),n.fatturatoSdm=s("FATTURATO_SDM","number"),n.ssc=s("SSC","number"),n.fatturatoSsc=s("FATTURATO_SSC","number"),n.yourBackup=s("YOUR_BACKUP","number"),n.fatturatoYourBackup=s("FATTURATO_YOUR_BACKUP","number"),n.cloudNas=s("CLOUD_NAS","number"),n.fatturatoCloudNas=s("FATTURATO_CLOUD_NAS","number"),n.easyGdpr=s("EASY_GDPR","number"),n.fatturatoEasyGdpr=s("FATTURATO_EASY_GDPR","number"),n.miia=s("MIIA","number"),n.fatturatoMiia=s("FATTURATO_MIIA","number"),n.fatturatoNuovoCliente=s("FATTURATO_NUOVO_CLIENTE","number"),n.bsalesMobile=s("BSALES_MOBILE","number"),n.pdaDigitale=s("PDA_DIGITALE","number"),n.totaleVoce=n.simVoce,n.totaleDati=n.adsl+n.fibra+n.fibraBusiness+n.simDati,n.totaleFastweb=n.fastwebEnergia,n.fatturatoProdotti=n.fatturatoVoce+n.fatturatoDati+n.fatturatoEasyRent+n.fatturatoOu+n.fatturatoOa+n.fatturatoEasyDeal+n.fatturatoAltro+n.fatturatoServiziDigitali+n.fatturatoCustom+n.fatturatoSdm+n.fatturatoSsc+n.fatturatoYourBackup+n.fatturatoCloudNas+n.fatturatoEasyGdpr+n.fatturatoMiia+n.fatturatoNuovoCliente,n}function F(e){let t=0;for(let a=0;a<e.length;a++)t=26*t+(e.charCodeAt(a)-"A".charCodeAt(0)+1);return t-1}function T(e){const t=e.match(/(\d{4})\.(\d{2})\.(\d{2})/);if(!t)throw new Error("Nome file non valido. Formato atteso: YYYY.MM.DD");const a=parseInt(t[1]),s=parseInt(t[2]);return{year:a,month:s,day:parseInt(t[3]),dateString:"".concat(t[1],"-").concat(t[2],"-").concat(t[3]),displayDate:"".concat(s,"/").concat(a)}}function z(e){return!e||isNaN(e)?"â‚¬0":new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function E(e){return!e||isNaN(e)?"0":new Intl.NumberFormat("it-IT",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}var D=a(9603),P=a(1385),I=a(7862),U=a(5418),M=a(9530),_=a(5916),L=a(4848);const q=e=>{let{open:t,onClose:a,onConfirm:s,title:n,message:i}=e;return(0,L.jsxs)(P.A,{open:t,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,L.jsx)(_.A,{id:"alert-dialog-title",children:n}),(0,L.jsx)(U.A,{children:(0,L.jsx)(M.A,{id:"alert-dialog-description",children:i})}),(0,L.jsxs)(I.A,{children:[(0,L.jsx)(D.A,{onClick:a,color:"primary",children:"Annulla"}),(0,L.jsx)(D.A,{onClick:s,color:"primary",autoFocus:!0,children:"Conferma"})]})]})},B=e=>"string"==typeof e&&e?e.split(".").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"N/A";var V=a(8686),G=a(6589),Y=a(6316),K=a(4180),W=a(7133);const H=e=>{var t;let{agent:a,onClick:s}=e;const n=(i=a,["simVoce","simDati","mnp","easyRent","adsl","linkOu","linkOa","sdm","ssc","yourBackup","cloudNas","miia","easyGdpr"].map(e=>({name:e,value:i[e]||0})).filter(e=>e.value>0).sort((e,t)=>t.value-e.value).slice(0,3).map(e=>({name:e.name.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()),value:e.value})));var i;const r=(l=a.fatturatoRush)>1e3?"performance-high":l>500?"performance-medium":"performance-low";var l;const o=e=>{let{icon:t,label:a,value:s}=e;return(0,L.jsxs)("div",{className:"stat-item-modern",children:[(0,L.jsx)("div",{className:"stat-icon-modern",children:t}),(0,L.jsxs)("div",{className:"stat-content-modern",children:[(0,L.jsx)("span",{className:"label",children:a}),(0,L.jsx)("span",{className:"value",children:s})]})]})};return(0,L.jsxs)("div",{className:"agent-card-modern",onClick:()=>s(a),children:[(0,L.jsxs)("div",{className:"card-header-modern ".concat(r),children:[(0,L.jsx)("div",{className:"avatar-modern",children:(0,L.jsx)(V.A,{size:24})}),(0,L.jsxs)("div",{className:"info-modern",children:[(0,L.jsx)("h3",{className:"name-modern",children:a.nome}),(0,L.jsx)("p",{className:"sm-modern",children:a.sm?B(a.sm):"N/A"})]})]}),(0,L.jsx)("div",{className:"card-body-modern",children:(0,L.jsxs)("div",{className:"stats-grid-modern",children:[(0,L.jsx)(o,{icon:(0,L.jsx)(G.A,{size:20}),label:"Fatturato",value:z((null===(t=a.fatturato)||void 0===t?void 0:t.complessivo)||0)}),(0,L.jsx)(o,{icon:(0,L.jsx)(Y.A,{size:20}),label:"Rush",value:z(a.fatturatoRush||0)}),(0,L.jsx)(o,{icon:(0,L.jsx)(K.A,{size:20}),label:"Bonus",value:z(a.bonusRisultati||0)})]})}),(0,L.jsxs)("div",{className:"card-footer-modern",children:[(0,L.jsxs)("h4",{className:"footer-title-modern",children:[(0,L.jsx)(W.A,{size:16}),"Top Prodotti"]}),(0,L.jsx)("div",{className:"products-container-modern",children:n.length>0?n.map(e=>(0,L.jsxs)("div",{className:"product-badge-modern",children:[e.name,": ",(0,L.jsx)("strong",{children:e.value})]},e.name)):(0,L.jsx)("p",{className:"no-products-modern",children:"Nessun prodotto di punta"})})]})]})};var J=a(961),Z=a(4653),Q=a(5721),$=a(9107),X=a(7984),ee=a(5869),te=a(6539),ae=a(8194),se=a(5751),ne=a(8450),ie=a(2307),re=a(8697),le=a(2864),oe=a(5107),ce=a(2250),de=a(684),ue=a(9574),me=a(2492),he=a(6858);const pe=e=>{let{message:t}=e;return(0,L.jsxs)("div",{className:"empty-state-compact",children:[(0,L.jsx)(W.A,{size:32,className:"empty-icon"}),(0,L.jsx)("p",{className:"empty-message",children:t})]})},xe=e=>{let{label:t,value:a,isCurrency:s=!1,icon:n}=e;const i=s?z(a||0):E(a||0);return 0===a||void 0===a?null:(0,L.jsxs)("div",{className:"modern-stat-item group hover:scale-105 transition-all duration-300",children:[(0,L.jsx)("div",{className:"stat-icon",children:n&&(0,L.jsx)(n,{size:20})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-label",children:t}),(0,L.jsx)("span",{className:"stat-value",children:i})]})]})},ve=e=>{let{currentValue:t,historicalValues:a,dataKey:s}=e;if(!a||a.length<1)return(0,L.jsx)("span",{className:"kpi-trend neutral",children:"N/A"});const n=a[a.length-1],i=n?n[s]:0;if(t>0&&0===i)return(0,L.jsx)("span",{className:"kpi-trend positive",children:"In crescita"});if(0===i)return(0,L.jsx)("span",{className:"kpi-trend neutral",children:"N/A"});const r=(t-i)/i*100;return Math.abs(r)<1?(0,L.jsx)("span",{className:"kpi-trend neutral",children:"Stabile"}):r>0?(0,L.jsxs)("span",{className:"kpi-trend positive",children:["+",r.toFixed(0),"%"]}):(0,L.jsxs)("span",{className:"kpi-trend negative",children:[r.toFixed(0),"%"]})},je=e=>{var t,a;let{agent:n,allData:i,onClose:r}=e;const[l,o]=(0,s.useState)(null),c=e=>{o(l===e?null:e)};(0,s.useEffect)(()=>{const e=e=>{27===e.keyCode&&r()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r]);const d=(0,s.useMemo)(()=>n&&i&&i.uploadedFiles?i.uploadedFiles.map(e=>{var t,a;const s=null===(t=e.data)||void 0===t||null===(t=t.agents)||void 0===t?void 0:t.find(e=>e.nome===n.originalNome);return s?{name:e.displayDate,rush:s.fatturatoRush||0,fatturato:(null===(a=s.fatturato)||void 0===a?void 0:a.complessivo)||0}:null}).filter(Boolean).reverse():[],[n,i]);if(!n)return null;const u=e=>{switch(e){case"fatturati":return[n.fatturatoVoce,n.fatturatoDati,n.fatturatoEasyRent,n.fatturatoOu,n.fatturatoOa,n.fatturatoEasyDeal,n.fatturatoServiziDigitali,n.fatturatoAltro,n.fatturatoCustom,n.fatturatoSdm,n.fatturatoSsc,n.fatturatoYourBackup,n.fatturatoCloudNas,n.fatturatoEasyGdpr,n.fatturatoMiia,n.fatturatoNuovoCliente].filter(e=>e&&e>0).length;case"digitali":return[n.sdm,n.ssc,n.yourBackup,n.cloudNas,n.miia,n.easyGdpr].filter(e=>e&&e>0).length;case"telefonia":return[n.adsl,n.linkOu,n.linkOa,n.simVoce,n.simDati,n.mnp,n.easyRent,n.linkOaStart,n.interniOa].filter(e=>e&&e>0).length;case"energia":return[n.fastwebEnergia].filter(e=>e&&e>0).length;default:return 0}};return J.createPortal((0,L.jsxs)("div",{className:"modal-overlay-modern",onClick:r,children:[(0,L.jsxs)("div",{className:"modal-content-modern",onClick:e=>e.stopPropagation(),children:[(0,L.jsxs)("div",{className:"modal-header-modern",children:[(0,L.jsxs)("div",{className:"agent-profile",children:[(0,L.jsx)("div",{className:"avatar-modern ".concat((e=>{const t=["bg-gradient-to-br from-blue-500 to-blue-600","bg-gradient-to-br from-green-500 to-green-600","bg-gradient-to-br from-purple-500 to-purple-600","bg-gradient-to-br from-orange-500 to-orange-600","bg-gradient-to-br from-pink-500 to-pink-600","bg-gradient-to-br from-indigo-500 to-indigo-600"];return t[(e||"").length%t.length]})(n.nome)),children:(0,L.jsx)(V.A,{size:32,className:"text-white"})}),(0,L.jsxs)("div",{className:"agent-info",children:[(0,L.jsx)("h1",{className:"agent-name",children:n.nome}),(0,L.jsxs)("div",{className:"agent-details",children:[(0,L.jsxs)("div",{className:"detail-item",children:[(0,L.jsx)(V.A,{size:16}),(0,L.jsx)("span",{children:n.sm?B(n.sm):""})]}),(0,L.jsxs)("div",{className:"detail-item",children:[(0,L.jsx)(ne.A,{size:16}),(0,L.jsx)("span",{children:n.distretto})]}),(0,L.jsxs)("div",{className:"detail-item",children:[(0,L.jsx)(ie.A,{size:16}),(0,L.jsx)("span",{children:"Ultimo aggiornamento: oggi"})]})]})]})]}),(0,L.jsx)("button",{className:"close-button-modern",onClick:r,children:(0,L.jsx)(re.A,{size:24})})]}),(0,L.jsxs)("div",{className:"kpi-section",children:[(0,L.jsxs)("div",{className:"kpi-card accent",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(Y.A,{size:28})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("span",{className:"kpi-label",children:"Fatturato Rush"}),(0,L.jsx)("span",{className:"kpi-value",children:z(n.fatturatoRush||0)}),(0,L.jsx)(ve,{currentValue:n.fatturatoRush||0,historicalValues:d,dataKey:"rush"})]})]}),(0,L.jsxs)("div",{className:"kpi-card primary",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(G.A,{size:28})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("span",{className:"kpi-label",children:"Fatturato Complessivo"}),(0,L.jsx)("span",{className:"kpi-value",children:z((null===(t=n.fatturato)||void 0===t?void 0:t.complessivo)||0)}),(0,L.jsx)(ve,{currentValue:(null===(a=n.fatturato)||void 0===a?void 0:a.complessivo)||0,historicalValues:d,dataKey:"fatturato"})]})]}),(0,L.jsxs)("div",{className:"kpi-card success",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(K.A,{size:28})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("span",{className:"kpi-label",children:"Bonus Risultati"}),(0,L.jsx)("span",{className:"kpi-value",children:z(n.bonusRisultati||0)})]})]}),(0,L.jsxs)("div",{className:"kpi-card info",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(V.A,{size:28})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("span",{className:"kpi-label",children:"Nuovi Clienti"}),(0,L.jsx)("span",{className:"kpi-value",children:E(n.nuovoCliente||0)})]})]})]}),(0,L.jsxs)("div",{className:"chart-section",children:[(0,L.jsxs)("h3",{className:"section-title",children:[(0,L.jsx)(Y.A,{size:20}),"Trend Performance Storico"]}),(0,L.jsx)("div",{className:"chart-container-modern",children:(0,L.jsx)(Z.u,{width:"100%",height:300,children:(0,L.jsxs)(Q.b,{data:d,children:[(0,L.jsx)($.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,L.jsx)(X.W,{dataKey:"name",stroke:"#64748b"}),(0,L.jsx)(ee.h,{yAxisId:"left",stroke:"#10b981"}),(0,L.jsx)(ee.h,{yAxisId:"right",orientation:"right",stroke:"#3b82f6"}),(0,L.jsx)(te.m,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0,0,0,0.1)"}}),(0,L.jsx)(ae.s,{}),(0,L.jsx)(se.N,{yAxisId:"left",type:"monotone",dataKey:"rush",stroke:"#10b981",strokeWidth:3,name:"Fatturato Rush",dot:{fill:"#10b981",strokeWidth:2,r:4}}),(0,L.jsx)(se.N,{yAxisId:"right",type:"monotone",dataKey:"fatturato",stroke:"#3b82f6",strokeWidth:3,name:"Fatturato Totale",dot:{fill:"#3b82f6",strokeWidth:2,r:4}})]})})})]}),(0,L.jsxs)("div",{className:"accordion-section",children:[(0,L.jsxs)("h3",{className:"section-title",children:[(0,L.jsx)(le.A,{size:20}),"Dettaglio Performance Prodotti"]}),(0,L.jsxs)("div",{className:"accordion-item",children:[(0,L.jsxs)("button",{className:"accordion-header ".concat("fatturati"===l?"active":""),onClick:()=>c("fatturati"),children:[(0,L.jsxs)("div",{className:"accordion-title",children:[(0,L.jsx)(G.A,{size:18}),(0,L.jsx)("span",{children:"Dettaglio Fatturati"})]}),(0,L.jsxs)("div",{className:"accordion-meta",children:[(0,L.jsx)("span",{className:"count-badge",children:u("fatturati")}),(0,L.jsx)(oe.A,{size:16,className:"chevron ".concat("fatturati"===l?"rotated":"")})]})]}),"fatturati"===l&&(0,L.jsx)("div",{className:"accordion-content",children:u("fatturati")>0?(0,L.jsxs)("div",{className:"stats-grid-compact",children:[(0,L.jsx)(xe,{label:"Fatturato Voce",value:n.fatturatoVoce,isCurrency:!0,icon:ce.A}),(0,L.jsx)(xe,{label:"Fatturato Dati",value:n.fatturatoDati,isCurrency:!0,icon:de.A}),(0,L.jsx)(xe,{label:"Fatturato Easy Rent",value:n.fatturatoEasyRent,isCurrency:!0,icon:ue.A}),(0,L.jsx)(xe,{label:"Fatturato OU",value:n.fatturatoOu,isCurrency:!0,icon:G.A}),(0,L.jsx)(xe,{label:"Fatturato OA",value:n.fatturatoOa,isCurrency:!0,icon:G.A}),(0,L.jsx)(xe,{label:"Fatturato Easy Deal",value:n.fatturatoEasyDeal,isCurrency:!0,icon:K.A}),(0,L.jsx)(xe,{label:"Fatturato Servizi Digitali",value:n.fatturatoServiziDigitali,isCurrency:!0,icon:me.A}),(0,L.jsx)(xe,{label:"Fatturato Altro",value:n.fatturatoAltro,isCurrency:!0,icon:G.A}),(0,L.jsx)(xe,{label:"Fatturato Custom",value:n.fatturatoCustom,isCurrency:!0,icon:G.A}),(0,L.jsx)(xe,{label:"Fatturato SDM",value:n.fatturatoSdm,isCurrency:!0,icon:me.A}),(0,L.jsx)(xe,{label:"Fatturato SSC",value:n.fatturatoSsc,isCurrency:!0,icon:de.A}),(0,L.jsx)(xe,{label:"Fatturato Your Backup",value:n.fatturatoYourBackup,isCurrency:!0,icon:me.A}),(0,L.jsx)(xe,{label:"Fatturato Cloud NAS",value:n.fatturatoCloudNas,isCurrency:!0,icon:de.A}),(0,L.jsx)(xe,{label:"Fatturato Easy GDPR",value:n.fatturatoEasyGdpr,isCurrency:!0,icon:me.A}),(0,L.jsx)(xe,{label:"Fatturato MIIA",value:n.fatturatoMiia,isCurrency:!0,icon:me.A}),(0,L.jsx)(xe,{label:"Fatturato Nuovo Cliente",value:n.fatturatoNuovoCliente,isCurrency:!0,icon:V.A})]}):(0,L.jsx)(pe,{message:"Nessun dato fatturato disponibile"})})]}),(0,L.jsxs)("div",{className:"accordion-item",children:[(0,L.jsxs)("button",{className:"accordion-header ".concat("digitali"===l?"active":""),onClick:()=>c("digitali"),children:[(0,L.jsxs)("div",{className:"accordion-title",children:[(0,L.jsx)(me.A,{size:18}),(0,L.jsx)("span",{children:"Servizi Digitali"})]}),(0,L.jsxs)("div",{className:"accordion-meta",children:[(0,L.jsx)("span",{className:"count-badge",children:u("digitali")}),(0,L.jsx)(oe.A,{size:16,className:"chevron ".concat("digitali"===l?"rotated":"")})]})]}),"digitali"===l&&(0,L.jsx)("div",{className:"accordion-content",children:u("digitali")>0?(0,L.jsxs)("div",{className:"stats-grid-compact",children:[(0,L.jsx)(xe,{label:"SDM",value:n.sdm,icon:me.A}),(0,L.jsx)(xe,{label:"SSC",value:n.ssc,icon:de.A}),(0,L.jsx)(xe,{label:"Your Backup",value:n.yourBackup,icon:me.A}),(0,L.jsx)(xe,{label:"Cloud NAS",value:n.cloudNas,icon:de.A}),(0,L.jsx)(xe,{label:"MIIA",value:n.miia,icon:me.A}),(0,L.jsx)(xe,{label:"Easy GDPR",value:n.easyGdpr,icon:me.A})]}):(0,L.jsx)(pe,{message:"Nessun servizio digitale attivo"})})]}),(0,L.jsxs)("div",{className:"accordion-item",children:[(0,L.jsxs)("button",{className:"accordion-header ".concat("telefonia"===l?"active":""),onClick:()=>c("telefonia"),children:[(0,L.jsxs)("div",{className:"accordion-title",children:[(0,L.jsx)(ce.A,{size:18}),(0,L.jsx)("span",{children:"Telefonia"})]}),(0,L.jsxs)("div",{className:"accordion-meta",children:[(0,L.jsx)("span",{className:"count-badge",children:u("telefonia")}),(0,L.jsx)(oe.A,{size:16,className:"chevron ".concat("telefonia"===l?"rotated":"")})]})]}),"telefonia"===l&&(0,L.jsx)("div",{className:"accordion-content",children:u("telefonia")>0?(0,L.jsxs)("div",{className:"stats-grid-compact",children:[(0,L.jsx)(xe,{label:"ADSL",value:n.adsl,icon:de.A}),(0,L.jsx)(xe,{label:"Link OU",value:n.linkOu,icon:ce.A}),(0,L.jsx)(xe,{label:"Link OA",value:n.linkOa,icon:ce.A}),(0,L.jsx)(xe,{label:"SIM Voce",value:n.simVoce,icon:ce.A}),(0,L.jsx)(xe,{label:"SIM Dati",value:n.simDati,icon:ue.A}),(0,L.jsx)(xe,{label:"MNP",value:n.mnp,icon:ue.A}),(0,L.jsx)(xe,{label:"Easy Rent",value:n.easyRent,icon:K.A}),(0,L.jsx)(xe,{label:"Link OA Start",value:n.linkOaStart,icon:ce.A}),(0,L.jsx)(xe,{label:"Interni OA",value:n.interniOa,icon:ce.A})]}):(0,L.jsx)(pe,{message:"Nessun contratto telefonico attivo"})})]}),(0,L.jsxs)("div",{className:"accordion-item",children:[(0,L.jsxs)("button",{className:"accordion-header ".concat("energia"===l?"active":""),onClick:()=>c("energia"),children:[(0,L.jsxs)("div",{className:"accordion-title",children:[(0,L.jsx)(he.A,{size:18}),(0,L.jsx)("span",{children:"Energia"})]}),(0,L.jsxs)("div",{className:"accordion-meta",children:[(0,L.jsx)("span",{className:"count-badge",children:u("energia")}),(0,L.jsx)(oe.A,{size:16,className:"chevron ".concat("energia"===l?"rotated":"")})]})]}),"energia"===l&&(0,L.jsx)("div",{className:"accordion-content",children:u("energia")>0?(0,L.jsx)("div",{className:"stats-grid-compact",children:(0,L.jsx)(xe,{label:"Fastweb Energia",value:n.fastwebEnergia,icon:he.A})}):(0,L.jsx)(pe,{message:"Nessun contratto energia attivo"})})]})]}),(0,L.jsx)("div",{className:"modal-footer-modern",children:(0,L.jsx)("div",{className:"footer-info",children:(0,L.jsxs)("span",{children:["ðŸ“Š Dati aggiornati al ",(new Date).toLocaleDateString("it-IT")]})})})]}),(0,L.jsx)("style",{jsx:!0,children:"\n        .modal-overlay-modern {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0, 0, 0, 0.7);\n          backdrop-filter: blur(8px);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 1000;\n          animation: fadeIn 0.3s ease;\n        }\n\n        .modal-content-modern {\n          background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n          border-radius: 24px;\n          width: 95%;\n          max-width: 1200px;\n          max-height: 95vh;\n          overflow-y: auto;\n          position: relative;\n          box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);\n          animation: slideInUp 0.4s ease;\n          border: 1px solid rgba(255, 255, 255, 0.2);\n        }\n\n        .modal-header-modern {\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          padding: 32px;\n          border-radius: 24px 24px 0 0;\n          color: white;\n          position: relative;\n          overflow: hidden;\n        }\n\n        .modal-header-modern::before {\n          content: '';\n          position: absolute;\n          top: -50%;\n          right: -50%;\n          width: 200%;\n          height: 200%;\n          background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);\n          animation: float 6s ease-in-out infinite;\n        }\n\n        .agent-profile {\n          display: flex;\n          align-items: center;\n          position: relative;\n          z-index: 2;\n        }\n\n        .avatar-modern {\n          width: 80px;\n          height: 80px;\n          border-radius: 20px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          margin-right: 24px;\n          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n          border: 3px solid rgba(255, 255, 255, 0.3);\n        }\n\n        .agent-info {\n          flex: 1;\n        }\n\n        .agent-name {\n          font-size: 2.5rem;\n          font-weight: 700;\n          margin: 0 0 16px 0;\n          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n        }\n\n        .agent-details {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 20px;\n          opacity: 0.9;\n        }\n\n        .detail-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          font-size: 0.95rem;\n        }\n\n        .close-button-modern {\n          position: absolute;\n          top: 24px;\n          right: 24px;\n          background: rgba(255, 255, 255, 0.2);\n          border: none;\n          width: 48px;\n          height: 48px;\n          border-radius: 12px;\n          color: white;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: all 0.2s ease;\n          backdrop-filter: blur(10px);\n          z-index: 3;\n        }\n\n        .close-button-modern:hover {\n          background: rgba(255, 255, 255, 0.3);\n          transform: scale(1.05);\n        }\n\n        .kpi-section {\n          padding: 32px;\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n          gap: 20px;\n        }\n\n        .kpi-card {\n          background: white;\n          border-radius: 16px;\n          padding: 24px;\n          display: flex;\n          align-items: center;\n          gap: 20px;\n          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n          border: 1px solid rgba(0, 0, 0, 0.05);\n          transition: all 0.3s ease;\n          position: relative;\n          overflow: hidden;\n        }\n\n        .kpi-card::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 4px;\n          background: var(--accent-color);\n        }\n\n        .kpi-card:hover {\n          transform: translateY(-2px);\n          box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);\n        }\n\n        .kpi-card.primary { --accent-color: linear-gradient(135deg, #3b82f6, #1d4ed8); }\n        .kpi-card.accent { --accent-color: linear-gradient(135deg, #10b981, #047857); }\n        .kpi-card.success { --accent-color: linear-gradient(135deg, #f59e0b, #d97706); }\n        .kpi-card.info { --accent-color: linear-gradient(135deg, #8b5cf6, #7c3aed); }\n\n        .kpi-icon {\n          width: 60px;\n          height: 60px;\n          border-radius: 16px;\n          background: var(--accent-color);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          color: white;\n          flex-shrink: 0;\n        }\n\n        .kpi-content {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          gap: 4px;\n        }\n\n        .kpi-label {\n          font-size: 0.9rem;\n          color: #64748b;\n          font-weight: 500;\n        }\n\n        .kpi-value {\n          font-size: 1.8rem;\n          font-weight: 700;\n          color: #1e293b;\n        }\n\n        .kpi-trend {\n          font-size: 0.8rem;\n          font-weight: 600;\n        }\n\n        .kpi-trend.positive { color: #10b981; }\n        .kpi-trend.negative { color: #ef4444; }\n        .kpi-trend.neutral { color: #64748b; }\n\n        .chart-section {\n          padding: 0 32px 32px;\n        }\n\n        .section-title {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          font-size: 18px;\n          font-weight: 600;\n          color: #1e293b;\n          margin-bottom: 20px;\n          padding-bottom: 12px;\n          border-bottom: 2px solid #f1f5f9;\n        }\n\n        .chart-container-modern {\n          background: white;\n          border-radius: 16px;\n          padding: 24px;\n          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n          border: 1px solid rgba(0, 0, 0, 0.05);\n        }\n\n        .accordion-section {\n          padding: 24px;\n          background: white;\n          border-radius: 16px;\n          margin: 16px 0;\n          border: 1px solid #e2e8f0;\n        }\n\n        .accordion-item {\n          border: 1px solid #e2e8f0;\n          border-radius: 12px;\n          margin-bottom: 8px;\n          overflow: hidden;\n          transition: all 0.2s ease;\n        }\n\n        .accordion-item:hover {\n          border-color: #cbd5e1;\n        }\n\n        .accordion-header {\n          width: 100%;\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 16px 20px;\n          background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n          border: none;\n          cursor: pointer;\n          transition: all 0.2s ease;\n          font-size: 15px;\n          font-weight: 500;\n        }\n\n        .accordion-header:hover {\n          background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n        }\n\n        .accordion-header.active {\n          background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);\n          color: #1d4ed8;\n        }\n\n        .accordion-title {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .accordion-meta {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n        }\n\n        .count-badge {\n          background: rgba(59, 130, 246, 0.1);\n          color: #1d4ed8;\n          font-size: 12px;\n          font-weight: 600;\n          padding: 4px 8px;\n          border-radius: 8px;\n          min-width: 24px;\n          text-align: center;\n        }\n\n        .accordion-header.active .count-badge {\n          background: rgba(255, 255, 255, 0.8);\n          color: #1d4ed8;\n        }\n\n        .chevron {\n          transition: transform 0.2s ease;\n          color: #64748b;\n        }\n\n        .chevron.rotated {\n          transform: rotate(180deg);\n        }\n\n        .accordion-content {\n          padding: 20px;\n          background: white;\n          border-top: 1px solid #e2e8f0;\n          animation: slideDown 0.3s ease;\n        }\n\n        @keyframes slideDown {\n          from {\n            opacity: 0;\n            transform: translateY(-10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        .stats-grid-compact {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 12px;\n        }\n\n        .empty-state-compact {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          padding: 32px 16px;\n          color: #64748b;\n          text-align: center;\n        }\n\n        .empty-icon {\n          opacity: 0.4;\n          margin-bottom: 8px;\n        }\n\n        .empty-message {\n          font-size: 14px;\n          opacity: 0.8;\n        }\n\n        .modern-stat-item {\n          background: #f8fafc;\n          border: 1px solid #e2e8f0;\n          border-radius: 12px;\n          padding: 20px;\n          display: flex;\n          align-items: center;\n          gap: 16px;\n          transition: all 0.2s ease;\n        }\n\n        .modern-stat-item:hover {\n          background: #f1f5f9;\n          border-color: #3b82f6;\n          transform: translateY(-1px);\n        }\n\n        .stat-icon {\n          width: 40px;\n          height: 40px;\n          border-radius: 10px;\n          background: linear-gradient(135deg, #3b82f6, #1d4ed8);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          color: white;\n          flex-shrink: 0;\n        }\n\n        .stat-content {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          gap: 4px;\n        }\n\n        .stat-label {\n          font-size: 0.9rem;\n          color: #64748b;\n          font-weight: 500;\n        }\n\n        .stat-value {\n          font-size: 1.3rem;\n          font-weight: 700;\n          color: #1e293b;\n        }\n\n        .modal-footer-modern {\n          background: #f8fafc;\n          padding: 24px 32px;\n          border-radius: 0 0 24px 24px;\n          border-top: 1px solid #e2e8f0;\n          text-align: center;\n        }\n\n        .footer-info {\n          color: #64748b;\n          font-size: 0.9rem;\n          font-weight: 500;\n        }\n\n        @keyframes fadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes slideInUp {\n          from { transform: translateY(30px); opacity: 0; }\n          to { transform: translateY(0); opacity: 1; }\n        }\n\n        @keyframes float {\n          0%, 100% { transform: translateY(0px); }\n          50% { transform: translateY(-20px); }\n        }\n\n        @media (max-width: 768px) {\n          .modal-content-modern {\n            width: 98%;\n            margin: 1%;\n            max-height: 98vh;\n          }\n\n          .agent-name {\n            font-size: 2rem;\n          }\n\n          .kpi-section {\n            grid-template-columns: 1fr;\n            padding: 24px;\n          }\n\n          .accordion-header {\n            padding: 14px 16px;\n            font-size: 14px;\n          }\n\n          .accordion-content {\n            padding: 16px;\n          }\n\n          .agent-profile {\n            flex-direction: column;\n            text-align: center;\n          }\n\n          .avatar-modern {\n            margin-right: 0;\n            margin-bottom: 16px;\n          }\n\n          .agent-details {\n            justify-content: center;\n          }\n\n          .stats-grid-compact {\n            grid-template-columns: 1fr;\n          }\n        }\n      "})]}),document.getElementById("modal-root")||document.body)};var ge=a(3893),fe=a(5977),be=a(5333),Ne=a(8445),Ae=a(1040);function ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function we(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(a),!0).forEach(function(t){ke(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ye(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function ke(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Ce=3e3,Se=()=>{var e;const{data:t,selectedFileDate:a,loadFiles:n,globalLoading:i}=na(),[r,l]=(0,s.useState)(null),[o,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)({searchTerm:"",selectedSm:"",fatturatoRushRange:[0,1e4],activePreset:null});(0,s.useEffect)(()=>{const e=new URLSearchParams(window.location.search),t={searchTerm:e.get("search")||"",selectedSm:e.get("sm")||"",fatturatoRushRange:[Number(e.get("minFatturatoRush"))||0,Number(e.get("maxFatturatoRush"))||1e4],activePreset:e.get("preset")||null};u(t)},[]),(0,s.useEffect)(()=>{const e=new URLSearchParams;d.searchTerm&&e.set("search",d.searchTerm),d.selectedSm&&e.set("sm",d.selectedSm),d.fatturatoRushRange[0]>0&&e.set("minFatturatoRush",d.fatturatoRushRange[0]),d.fatturatoRushRange[1]<1e4&&e.set("maxFatturatoRush",d.fatturatoRushRange[1]),d.activePreset&&e.set("preset",d.activePreset),window.history.replaceState({},"","".concat(window.location.pathname,"?").concat(e.toString()))},[d]);const{agents:m,smList:h,maxFatturatoRush:p,allAgentsInPeriod:x}=(0,s.useMemo)(()=>{if(!a||!t.uploadedFiles||0===t.uploadedFiles.length)return{agents:[],smList:[],maxFatturatoRush:Ce,allAgentsInPeriod:[]};const e=t.uploadedFiles.find(e=>e.date===a);if(!e||!e.data||!e.data.agents)return{agents:[],smList:[],maxFatturatoRush:Ce,allAgentsInPeriod:[]};const s=e.data.agents.map((t,a)=>we(we({},t),{},{id:"".concat(e.date,"-").concat(t.nome,"-").concat(a),originalNome:t.nome,nome:B(t.nome)})),n=[...new Set(s.map(e=>e.sm).filter(Boolean))].sort(),i=Math.max(...s.map(e=>e.fatturatoRush||0));return{agents:s.filter(e=>(e.nome.toLowerCase().includes(d.searchTerm.toLowerCase())||e.originalNome&&e.originalNome.toLowerCase().includes(d.searchTerm.toLowerCase()))&&(""===d.selectedSm||e.sm===d.selectedSm)&&(e.fatturatoRush||0)>=d.fatturatoRushRange[0]&&(e.fatturatoRush||0)<=d.fatturatoRushRange[1]),smList:n,maxFatturatoRush:i,allAgentsInPeriod:s}},[t.uploadedFiles,a,d]),v=(e,t)=>{if("fatturatoRushRange"===e){const[e,a]=t;u(t=>we(we({},t),{},{fatturatoRushRange:[e,a],activePreset:null}))}else u(a=>we(we({},a),{},{[e]:t,activePreset:null}))},j=e=>{let t=we(we({},d),{},{searchTerm:"",selectedSm:"",activePreset:e});switch(e){case"top":t.fatturatoRushRange=[1e3,p];break;case"underperforming":t.fatturatoRushRange=[0,500];break;case"average":t.fatturatoRushRange=[500,1e3];break;default:t.fatturatoRushRange=[0,p],t.activePreset=null}u(t)},g=(0,s.useMemo)(()=>{const e=m.length;return{totalAgents:e,avgRush:e>0?m.reduce((e,t)=>e+(t.fatturatoRush||0),0)/e:0,topPerformer:m.reduce((e,t)=>(t.fatturatoRush||0)>((null==e?void 0:e.fatturatoRush)||0)?t:e,null),totalRevenue:m.reduce((e,t)=>{var a;return e+((null===(a=t.fatturato)||void 0===a?void 0:a.complessivo)||0)},0)}},[m]),f=[{value:0,label:"0â‚¬"},{value:500,label:"500â‚¬"},{value:1e3,label:"1kâ‚¬"},{value:Ce,label:"".concat(3,"kâ‚¬+")}];return(0,L.jsxs)("div",{className:"modern-agents-container",children:[(0,L.jsxs)("div",{className:"page-header",children:[(0,L.jsxs)("div",{className:"header-content",children:[(0,L.jsxs)("div",{className:"header-text",children:[(0,L.jsxs)("h1",{className:"page-title",children:[(0,L.jsx)(ge.A,{size:32})," Dashboard Agenti"]}),(0,L.jsx)("p",{className:"page-subtitle",children:"Gestisci e monitora le performance del tuo team commerciale"})]}),(0,L.jsxs)("button",{className:"refresh-btn ".concat(o||i?"refreshing":""),onClick:async()=>{c(!0),await n(),c(!1)},disabled:o||i,children:[(0,L.jsx)(fe.A,{size:20}),o||i?"Aggiornamento...":"Aggiorna Dati"]})]}),(0,L.jsxs)("div",{className:"header-stats",children:[(0,L.jsxs)("div",{className:"stat-card primary",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(ge.A,{size:24})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:g.totalAgents}),(0,L.jsx)("span",{className:"stat-label",children:"Agenti Visualizzati"})]})]}),(0,L.jsxs)("div",{className:"stat-card success",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(Y.A,{size:24})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsxs)("span",{className:"stat-value",children:["â‚¬",g.avgRush.toLocaleString("it-IT",{maximumFractionDigits:0})]}),(0,L.jsx)("span",{className:"stat-label",children:"Rush Medio"})]})]}),(0,L.jsxs)("div",{className:"stat-card accent",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(K.A,{size:24})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:(null===(e=g.topPerformer)||void 0===e||null===(e=e.nome)||void 0===e?void 0:e.split(" ")[0])||"N/A"}),(0,L.jsx)("span",{className:"stat-label",children:"Top Performer"})]})]}),(0,L.jsxs)("div",{className:"stat-card info",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(le.A,{size:24})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsxs)("span",{className:"stat-value",children:["â‚¬",(g.totalRevenue/1e3).toFixed(0),"K"]}),(0,L.jsx)("span",{className:"stat-label",children:"Fatturato Totale"})]})]})]})]}),(0,L.jsxs)("div",{className:"filters-modern",children:[(0,L.jsxs)("div",{className:"filters-header",children:[(0,L.jsxs)("div",{className:"filters-title",children:[(0,L.jsx)(be.A,{size:20}),(0,L.jsx)("span",{children:"Filtri Avanzati"})]}),(0,L.jsxs)("div",{className:"results-count",children:[m.length," di ",x.length," agenti"]})]}),(0,L.jsxs)("div",{className:"filters-grid",children:[(0,L.jsxs)("div",{className:"filter-group search-group",children:[(0,L.jsxs)("label",{className:"filter-label",children:[(0,L.jsx)(Ne.A,{size:16})," Ricerca Agente"]}),(0,L.jsx)("div",{className:"search-input-wrapper",children:(0,L.jsx)("input",{type:"text",placeholder:"Cerca per nome...",value:d.searchTerm,onChange:e=>v("searchTerm",e.target.value),className:"modern-search-input"})})]}),(0,L.jsxs)("div",{className:"filter-group",children:[(0,L.jsxs)("label",{className:"filter-label",children:[(0,L.jsx)(ge.A,{size:16})," Coordinatore"]}),(0,L.jsxs)("select",{value:d.selectedSm,onChange:e=>v("selectedSm",e.target.value),className:"modern-select",children:[(0,L.jsx)("option",{value:"",children:"Tutti i Coordinatori"}),h.map(e=>(0,L.jsx)("option",{value:e,children:B(e)},e))]})]}),(0,L.jsxs)("div",{className:"filter-group range-group",children:[(0,L.jsxs)("label",{className:"filter-label",children:[(0,L.jsx)(Y.A,{size:16})," Range Fatturato Rush"]}),(0,L.jsx)(Ae.Ay,{value:d.fatturatoRushRange.map(e=>Math.min(e,Ce)),onChange:(e,t)=>v("fatturatoRushRange",t),valueLabelDisplay:"auto",min:0,max:Ce,step:100,marks:f,valueLabelFormat:e=>"".concat(e.toLocaleString("it-IT"),e===Ce?"â‚¬+":"â‚¬"),sx:{mt:2}})]}),(0,L.jsxs)("div",{className:"filter-group preset-group",children:[(0,L.jsx)("label",{className:"filter-label",children:"Filtri Rapidi"}),(0,L.jsxs)("div",{className:"preset-buttons",children:[(0,L.jsx)("button",{onClick:()=>j("top"),className:"preset-btn ".concat("top"===d.activePreset?"active":""),children:"ðŸ† Top Performers"}),(0,L.jsx)("button",{onClick:()=>j("average"),className:"preset-btn ".concat("average"===d.activePreset?"active":""),children:"ðŸ“Š Performance Media"}),(0,L.jsx)("button",{onClick:()=>j("underperforming"),className:"preset-btn ".concat("underperforming"===d.activePreset?"active":""),children:"ðŸ”„ In Crescita"}),(0,L.jsx)("button",{onClick:()=>j(null),className:"preset-btn reset",children:"âœ¨ Reset Filtri"})]})]})]})]}),(0,L.jsx)("div",{className:"agents-grid-modern ".concat(i?"loading":""),children:m.length>0?m.map(e=>(0,L.jsx)(H,{agent:e,onClick:l},e.id)):(0,L.jsxs)("div",{className:"no-results-modern",children:[(0,L.jsx)("div",{className:"no-results-icon",children:(0,L.jsx)(Ne.A,{size:48})}),(0,L.jsx)("h3",{children:"Nessun agente trovato"}),(0,L.jsx)("p",{children:"Prova a modificare i filtri di ricerca per visualizzare piÃ¹ risultati."}),(0,L.jsx)("button",{className:"reset-filters-btn",onClick:()=>u({searchTerm:"",selectedSm:"",fatturatoRushRange:[0,p],activePreset:null}),children:"Ripristina Tutti i Filtri"})]})}),i&&(0,L.jsx)("div",{className:"loading-overlay",children:(0,L.jsxs)("div",{className:"loading-spinner",children:[(0,L.jsx)(fe.A,{size:32,className:"animate-spin"}),(0,L.jsx)("p",{children:"Caricamento agenti..."})]})}),r&&(0,L.jsx)(je,{agent:r,allData:t,onClose:()=>l(null)})]})};var Re=a(6846),Oe=a(5899),Fe=a(4338),Te=a(7792),ze=a(2102),Ee=a(1181);const De=e=>new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(e||0),Pe=e=>new Intl.NumberFormat("it-IT").format(e||0),Ie=()=>{const{data:e,selectedFileDate:t}=na(),[a,n]=(0,s.useState)("totalRush"),[i,r]=(0,s.useState)("desc"),[l,o]=(0,s.useState)("rush"),[c,d]=(0,s.useState)(null),u=(0,s.useMemo)(()=>{var a,s;if(!t||null===(a=e.uploadedFiles)||void 0===a||!a.length)return[];const n=e.uploadedFiles.find(e=>e.date===t);if(null==n||null===(s=n.data)||void 0===s||!s.agents)return[];const i={};return n.data.agents.forEach(e=>{var t;const a=e.sm||"Senza SM";i[a]||(i[a]={name:a,team:[],totalAgents:0,totalRush:0,totalRevenue:0,totalNewClients:0,avgRush:0}),i[a].team.push(e),i[a].totalAgents++,i[a].totalRush+=e.fatturatoRush||0,i[a].totalRevenue+=(null===(t=e.fatturato)||void 0===t?void 0:t.complessivo)||0,i[a].totalNewClients+=e.nuovoCliente||0}),Object.values(i).forEach(e=>{e.avgRush=e.totalAgents>0?e.totalRush/e.totalAgents:0,e.team.sort((e,t)=>(t.fatturatoRush||0)-(e.fatturatoRush||0))}),Object.values(i)},[e,t]),m=(0,s.useMemo)(()=>[...u].sort((e,t)=>{let s=e[a]||0,n=t[a]||0;return"desc"===i?n-s:s-n}),[u,a,i]),h=e=>{a===e?r("desc"===i?"asc":"desc"):(n(e),r("desc"))},p=e=>{o(e),"rush"===e?n("totalRush"):"revenue"===e?n("totalRevenue"):"team"===e&&n("totalAgents"),r("desc")},x=e=>{switch(e){case 0:return(0,L.jsx)(Re.A,{size:24,className:"text-yellow-500"});case 1:return(0,L.jsx)(Oe.A,{size:24,className:"text-gray-400"});case 2:return(0,L.jsx)(Fe.A,{size:24,className:"text-amber-600"});default:return(0,L.jsx)("span",{className:"rank-number",children:e+1})}},v=(e,t)=>{switch(t){case"rush":return e>=8e3?"text-green-600":e>=6e3?"text-blue-600":e>=4e3?"text-yellow-600":"text-red-600";case"revenue":return e>=25e3?"text-green-600":e>=2e4?"text-blue-600":e>=15e3?"text-yellow-600":"text-red-600";default:return"text-gray-600"}},j=(0,s.useMemo)(()=>({totalSMs:m.length,totalAgents:m.reduce((e,t)=>e+t.totalAgents,0),totalRush:m.reduce((e,t)=>e+t.totalRush,0),totalRevenue:m.reduce((e,t)=>e+t.totalRevenue,0),avgTeamSize:m.length>0?m.reduce((e,t)=>e+t.totalAgents,0)/m.length:0}),[m]);return(0,L.jsxs)("div",{className:"modern-sm-ranking",children:[(0,L.jsxs)("div",{className:"ranking-header",children:[(0,L.jsxs)("div",{className:"header-content",children:[(0,L.jsxs)("div",{className:"title-section",children:[(0,L.jsxs)("h1",{className:"page-title",children:[(0,L.jsx)(Oe.A,{size:32}),"Classifica Sales Manager"]}),(0,L.jsx)("p",{className:"page-subtitle",children:"Performance e ranking dei coordinatori commerciali"})]}),(0,L.jsxs)("div",{className:"metrics-selector",children:[(0,L.jsx)("label",{className:"metric-label",children:"Vista:"}),(0,L.jsxs)("div",{className:"metric-buttons",children:[(0,L.jsxs)("button",{className:"metric-btn ".concat("rush"===l?"active":""),onClick:()=>p("rush"),children:[(0,L.jsx)(Y.A,{size:16}),"Rush Focus"]}),(0,L.jsxs)("button",{className:"metric-btn ".concat("revenue"===l?"active":""),onClick:()=>p("revenue"),children:[(0,L.jsx)(G.A,{size:16}),"Fatturato"]}),(0,L.jsxs)("button",{className:"metric-btn ".concat("team"===l?"active":""),onClick:()=>p("team"),children:[(0,L.jsx)(ge.A,{size:16}),"Team"]})]})]})]}),(0,L.jsxs)("div",{className:"global-stats",children:[(0,L.jsxs)("div",{className:"stat-card primary",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(ge.A,{size:28})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:j.totalSMs}),(0,L.jsx)("span",{className:"stat-label",children:"Sales Manager"})]})]}),(0,L.jsxs)("div",{className:"stat-card success",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(Te.A,{size:28})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:j.totalAgents}),(0,L.jsx)("span",{className:"stat-label",children:"Agenti Totali"})]})]}),(0,L.jsxs)("div",{className:"stat-card accent",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(Y.A,{size:28})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:De(j.totalRush)}),(0,L.jsx)("span",{className:"stat-label",children:"Rush Totale"})]})]}),(0,L.jsxs)("div",{className:"stat-card info",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(le.A,{size:28})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:j.avgTeamSize.toFixed(1)}),(0,L.jsx)("span",{className:"stat-label",children:"Agenti/SM Medio"})]})]})]})]}),(0,L.jsx)("div",{className:"controls-section",children:(0,L.jsxs)("div",{className:"sort-controls",children:[(0,L.jsxs)("span",{className:"sort-label",children:[(0,L.jsx)(be.A,{size:16}),"Ordina per:"]}),(0,L.jsxs)("div",{className:"sort-buttons",children:[(0,L.jsxs)("button",{className:"sort-btn ".concat("totalRush"===a?"active":""),onClick:()=>h("totalRush"),children:["Rush Totale","totalRush"===a&&("desc"===i?(0,L.jsx)(oe.A,{size:16}):(0,L.jsx)(ze.A,{size:16}))]}),(0,L.jsxs)("button",{className:"sort-btn ".concat("avgRush"===a?"active":""),onClick:()=>h("avgRush"),children:["Rush Medio","avgRush"===a&&("desc"===i?(0,L.jsx)(oe.A,{size:16}):(0,L.jsx)(ze.A,{size:16}))]}),(0,L.jsxs)("button",{className:"sort-btn ".concat("totalRevenue"===a?"active":""),onClick:()=>h("totalRevenue"),children:["Fatturato","totalRevenue"===a&&("desc"===i?(0,L.jsx)(oe.A,{size:16}):(0,L.jsx)(ze.A,{size:16}))]}),(0,L.jsxs)("button",{className:"sort-btn ".concat("totalAgents"===a?"active":""),onClick:()=>h("totalAgents"),children:["Team Size","totalAgents"===a&&("desc"===i?(0,L.jsx)(oe.A,{size:16}):(0,L.jsx)(ze.A,{size:16}))]})]})]})}),(0,L.jsx)("div",{className:"sm-list",children:m.length>0?m.map((e,t)=>{return(0,L.jsxs)("div",{className:"sm-card ".concat((a=e.avgRush,a>=8e3?"excellent":a>=6e3?"good":a>=4e3?"average":"needs-improvement")),children:[(0,L.jsxs)("div",{className:"sm-header",onClick:()=>d(c===e.name?null:e.name),children:[(0,L.jsx)("div",{className:"rank-section",children:x(t)}),(0,L.jsxs)("div",{className:"sm-info",children:[(0,L.jsx)("h3",{className:"sm-name",children:B(e.name)}),(0,L.jsxs)("div",{className:"sm-meta",children:[(0,L.jsxs)("span",{className:"team-count",children:[(0,L.jsx)(ge.A,{size:14}),e.totalAgents," agenti"]}),(0,L.jsxs)("span",{className:"avg-indicator",children:[(0,L.jsx)(Te.A,{size:14}),"Avg: ",De(e.avgRush)]})]})]}),(0,L.jsxs)("div",{className:"sm-metrics",children:["rush"===l&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"metric-item primary",children:[(0,L.jsx)("span",{className:"metric-label",children:"Rush Totale"}),(0,L.jsx)("span",{className:"metric-value ".concat(v(e.totalRush,"rush")),children:De(e.totalRush)})]}),(0,L.jsxs)("div",{className:"metric-item secondary",children:[(0,L.jsx)("span",{className:"metric-label",children:"Fatturato"}),(0,L.jsx)("span",{className:"metric-value ".concat(v(e.totalRevenue,"revenue")),children:De(e.totalRevenue)})]})]}),"revenue"===l&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"metric-item primary",children:[(0,L.jsx)("span",{className:"metric-label",children:"Fatturato"}),(0,L.jsx)("span",{className:"metric-value ".concat(v(e.totalRevenue,"revenue")),children:De(e.totalRevenue)})]}),(0,L.jsxs)("div",{className:"metric-item secondary",children:[(0,L.jsx)("span",{className:"metric-label",children:"Rush Totale"}),(0,L.jsx)("span",{className:"metric-value ".concat(v(e.totalRush,"rush")),children:De(e.totalRush)})]})]}),"team"===l&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"metric-item primary",children:[(0,L.jsx)("span",{className:"metric-label",children:"Agenti"}),(0,L.jsx)("span",{className:"metric-value",children:Pe(e.totalAgents)})]}),(0,L.jsxs)("div",{className:"metric-item secondary",children:[(0,L.jsx)("span",{className:"metric-label",children:"Rush Medio"}),(0,L.jsx)("span",{className:"metric-value",children:De(e.avgRush)})]})]}),(0,L.jsxs)("div",{className:"metric-item tertiary",children:[(0,L.jsx)("span",{className:"metric-label",children:"Nuovi Clienti"}),(0,L.jsx)("span",{className:"metric-value text-purple-600",children:Pe(e.totalNewClients)})]})]}),(0,L.jsx)("div",{className:"expand-indicator",children:c===e.name?(0,L.jsx)(ze.A,{size:20}):(0,L.jsx)(oe.A,{size:20})})]}),c===e.name&&(0,L.jsxs)("div",{className:"team-details",children:[(0,L.jsx)("div",{className:"team-header",children:(0,L.jsxs)("h4",{children:[(0,L.jsx)(Ee.A,{size:16}),"Team di ",B(e.name)]})}),(0,L.jsx)("div",{className:"agents-grid",children:e.team.map((e,t)=>{var a;return(0,L.jsxs)("div",{className:"agent-mini-card",children:[(0,L.jsxs)("div",{className:"agent-rank",children:["#",t+1]}),(0,L.jsxs)("div",{className:"agent-info",children:[(0,L.jsx)("h5",{className:"agent-name",children:B(e.nome)}),(0,L.jsxs)("div",{className:"agent-metrics",children:[(0,L.jsxs)("div",{className:"agent-metric",children:[(0,L.jsx)("span",{className:"label",children:"Rush:"}),(0,L.jsx)("span",{className:"value rush",children:De(e.fatturatoRush||0)})]}),(0,L.jsxs)("div",{className:"agent-metric",children:[(0,L.jsx)("span",{className:"label",children:"Fatturato:"}),(0,L.jsx)("span",{className:"value revenue",children:De((null===(a=e.fatturato)||void 0===a?void 0:a.complessivo)||0)})]}),(0,L.jsxs)("div",{className:"agent-metric",children:[(0,L.jsx)("span",{className:"label",children:"Clienti:"}),(0,L.jsx)("span",{className:"value clients",children:Pe(e.nuovoCliente||0)})]})]})]})]},e.nome)})})]})]},e.name);var a}):(0,L.jsxs)("div",{className:"no-data",children:[(0,L.jsx)(Oe.A,{size:48,className:"opacity-30"}),(0,L.jsx)("h3",{children:"Nessun dato disponibile"}),(0,L.jsx)("p",{children:"Carica un file Excel per visualizzare la classifica SM"})]})})]})};var Ue=a(3167),Me=a(9655),_e=a(2050),Le=a(8224),qe=a(2703),Be=a(5614),Ve=a(300),Ge=a(2514),Ye=a(116),Ke=a(6844),We=a(8818);function He(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function Je(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Ze=e=>new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(e||0),Qe=e=>new Intl.NumberFormat("it-IT").format(e||0),$e=()=>{const{data:e,selectedFileDate:t}=na(),[a,n]=(0,s.useState)("all"),[i,r]=(0,s.useState)("volume"),[l,o]=(0,s.useState)("cards"),[c,d]=(0,s.useState)("pie"),[u,m]=(0,s.useState)("fatturato"),h=["#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444","#6366f1","#84cc16","#f97316","#ec4899","#14b8a6"],p=(0,s.useMemo)(()=>({mobile:{name:"Telefonia Mobile",icon:ue.A,color:"from-blue-500 to-blue-600",products:["simVoce","simDati","mnp","easyRent"]},fixed:{name:"Telefonia Fissa",icon:ce.A,color:"from-green-500 to-green-600",products:["adsl","linkOu","linkOa","linkOaStart","interniOa"]},digital:{name:"Servizi Digitali",icon:me.A,color:"from-purple-500 to-purple-600",products:["sdm","ssc","yourBackup","cloudNas","miia","easyGdpr"]},energy:{name:"Energia",icon:he.A,color:"from-orange-500 to-orange-600",products:["fastwebEnergia"]},special:{name:"Prodotti Speciali",icon:K.A,color:"from-pink-500 to-pink-600",products:["station"]}}),[]),x=(0,s.useMemo)(()=>{var a,s,n;if(!t||null===(a=e.uploadedFiles)||void 0===a||!a.length)return{};let i=null;const r=e.uploadedFiles.find(e=>e.date===t);if(null!=r&&null!==(s=r.data)&&void 0!==s&&s.agents?i=r.data.agents:e.processedData&&null!==(n=e.processedData[t])&&void 0!==n&&n.agents&&(i=e.processedData[t].agents),!i||!Array.isArray(i)||0===i.length)return{};const l={},o={simVoce:"SIM Voce",simDati:"SIM Dati",mnp:"MNP",easyRent:"Easy Rent",adsl:"ADSL",linkOu:"Link OU",linkOa:"Link OA",linkOaStart:"Link OA Start",interniOa:"Interni OA",sdm:"SDM",ssc:"SSC",yourBackup:"Your Backup",cloudNas:"Cloud NAS",miia:"MIIA",easyGdpr:"Easy GDPR",fastwebEnergia:"Fastweb Energia",station:"Station"},c={simVoce:"fatturatoVoce",simDati:"fatturatoDati",easyRent:"fatturatoEasyRent",linkOu:"fatturatoOu",linkOa:"fatturatoOa",easyDeal:"fatturatoEasyDeal",altro:"fatturatoAltro",serviziDigitali:"fatturatoServiziDigitali",custom:"fatturatoCustom",sdm:"fatturatoSdm",ssc:"fatturatoSsc",yourBackup:"fatturatoYourBackup",cloudNas:"fatturatoCloudNas",easyGdpr:"fatturatoEasyGdpr",miia:"fatturatoMiia",nuovoCliente:"fatturatoNuovoCliente"};return Object.keys(o).forEach(e=>{const t=c[e]||"fatturato".concat(e.charAt(0).toUpperCase()+e.slice(1)),a=i.filter(e=>e&&"object"==typeof e).map(a=>({nome:a.nome||"N/A",volume:Number(a[e])||0,fatturato:Number(a[t])||0})).filter(e=>e.volume>0).sort((e,t)=>t.volume-e.volume);a.length>0&&(l[e]={displayName:o[e],volume:a.reduce((e,t)=>e+t.volume,0),fatturato:a.reduce((e,t)=>e+t.fatturato,0),agents:a.length,topAgents:a.slice(0,3).map(e=>B(e.nome))})}),l},[e,t]),v=(0,s.useMemo)(()=>{var e;if("all"===a)return x;const t=(null===(e=p[a])||void 0===e?void 0:e.products)||[];return Object.fromEntries(Object.entries(x).filter(e=>{let[a]=e;return t.includes(a)}))},[x,a,p]),j=(0,s.useMemo)(()=>Object.entries(v).sort((e,t)=>{let[,a]=e,[,s]=t;switch(i){case"volume":return s.volume-a.volume;case"fatturato":return s.fatturato-a.fatturato;case"agents":return s.agents-a.agents;default:return 0}}),[v,i]),g=(0,s.useMemo)(()=>{const e=Object.values(v);return{totalVolume:e.reduce((e,t)=>e+t.volume,0),totalRevenue:e.reduce((e,t)=>e+t.fatturato,0),totalProducts:e.length}},[v]),f=e=>({simVoce:ue.A,simDati:de.A,mnp:he.A,easyRent:ce.A,adsl:Ye.A,linkOu:me.A,linkOa:Ee.A}[e]||W.A),b=e=>({simVoce:"linear-gradient(135deg, #3b82f6, #1d4ed8)",simDati:"linear-gradient(135deg, #06b6d4, #0891b2)",mnp:"linear-gradient(135deg, #8b5cf6, #7c3aed)",easyRent:"linear-gradient(135deg, #10b981, #059669)",adsl:"linear-gradient(135deg, #f59e0b, #d97706)",linkOu:"linear-gradient(135deg, #ef4444, #dc2626)",linkOa:"linear-gradient(135deg, #6366f1, #4f46e5)"}[e]||"linear-gradient(135deg, #64748b, #475569)"),N=(0,s.useMemo)(()=>Object.entries(v).map(e=>{let[t,a]=e;return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?He(Object(a),!0).forEach(function(t){Je(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):He(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({name:t},a)}),[v]),A=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=Number(e)||0;switch(u){case"fatturato":return Ze(a);case"agents":return function(e){let{includeUnit:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=Number(e)||0,s=Qe(a);if(!t)return s;const n=1===a?"agente":"agenti";return"".concat(s," ").concat(n)}(a,t);default:return Qe(a)}},[u]),y=(0,s.useMemo)(()=>{if(!N||!Array.isArray(N)||0===N.length)return[];try{return N.filter(e=>e&&e.name&&"object"==typeof e&&null!==e.name&&void 0!==e.name&&""!==e.name).map(e=>{try{let a=0;"fatturato"===u?a=Number(e.fatturato)||0:"volume"===u?a=Number(e.volume)||0:"agents"===u&&(a=Number(e.agents)||0);const s={simVoce:"SIM Voce",simDati:"SIM Dati",mnp:"PortabilitÃ ",easyRent:"Easy Rent",adsl:"ADSL",linkOu:"Link OU",linkOa:"Link OA",linkOaStart:"Link OA Start",interniOa:"Interni OA"}[t=e.name]||t;return s?{name:String(s),value:Math.max(0,Number(a)||0),originalName:e.name}:null}catch(e){return null}var t}).filter(e=>e&&e.value>0&&"string"==typeof e.name&&"number"==typeof e.value&&!isNaN(e.value)).sort((e,t)=>(t.value||0)-(e.value||0))}catch(e){return[]}},[N,u]);return(0,L.jsxs)("div",{className:"modern-products-analysis",children:[(0,L.jsxs)("div",{className:"products-header",children:[(0,L.jsxs)("div",{className:"header-content",children:[(0,L.jsxs)("div",{className:"title-section",children:[(0,L.jsxs)("h1",{className:"page-title",children:[(0,L.jsx)(W.A,{size:32}),"Analisi Prodotti"]}),(0,L.jsx)("p",{className:"page-subtitle",children:"Performance e trends dei prodotti commerciali"})]}),(0,L.jsx)("div",{className:"view-controls",children:(0,L.jsxs)("div",{className:"view-mode-selector",children:[(0,L.jsxs)("button",{className:"view-btn ".concat("cards"===l?"active":""),onClick:()=>o("cards"),children:[(0,L.jsx)(le.A,{size:16}),"Cards"]}),(0,L.jsxs)("button",{className:"view-btn ".concat("table"===l?"active":""),onClick:()=>o("table"),children:[(0,L.jsx)(Ke.A,{size:16}),"Tabella"]}),(0,L.jsxs)("button",{className:"view-btn ".concat("chart"===l?"active":""),onClick:()=>o("chart"),children:[(0,L.jsx)(We.A,{size:16}),"Grafici"]})]})})]}),(0,L.jsxs)("div",{className:"global-stats",children:[(0,L.jsxs)("div",{className:"stat-card primary",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(W.A,{size:28})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:g.totalProducts}),(0,L.jsx)("span",{className:"stat-label",children:"Prodotti Attivi"})]})]}),(0,L.jsxs)("div",{className:"stat-card success",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(Te.A,{size:28})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:Qe(g.totalVolume)}),(0,L.jsx)("span",{className:"stat-label",children:"Volume Totale"})]})]}),(0,L.jsxs)("div",{className:"stat-card accent",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(Y.A,{size:28})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:Ze(g.totalRevenue)}),(0,L.jsx)("span",{className:"stat-label",children:"Fatturato Prodotti"})]})]})]})]}),(0,L.jsxs)("div",{className:"controls-section",children:[(0,L.jsxs)("div",{className:"category-filters",children:[(0,L.jsxs)("span",{className:"filter-label",children:[(0,L.jsx)(be.A,{size:16}),"Categorie:"]}),(0,L.jsxs)("div",{className:"category-buttons",children:[(0,L.jsxs)("button",{className:"category-btn ".concat("all"===a?"active":""),onClick:()=>n("all"),children:[(0,L.jsx)(W.A,{size:16}),"Tutti"]}),Object.entries(p).map(e=>{let[t,s]=e;const i=s.icon;return(0,L.jsxs)("button",{className:"category-btn ".concat(a===t?"active":""),onClick:()=>n(t),children:[(0,L.jsx)(i,{size:16}),s.name]},t)})]})]}),(0,L.jsxs)("div",{className:"sort-controls",children:[(0,L.jsx)("span",{className:"sort-label",children:"Ordina per:"}),(0,L.jsxs)("div",{className:"sort-buttons",children:[(0,L.jsx)("button",{className:"sort-btn ".concat("volume"===i?"active":""),onClick:()=>r("volume"),children:"Volume"}),(0,L.jsx)("button",{className:"sort-btn ".concat("fatturato"===i?"active":""),onClick:()=>r("fatturato"),children:"Fatturato"}),(0,L.jsx)("button",{className:"sort-btn ".concat("agents"===i?"active":""),onClick:()=>r("agents"),children:"Agenti"})]})]})]}),"cards"===l&&(0,L.jsx)("div",{className:"products-grid",children:j.length>0?j.map(e=>{let[t,a]=e;const s=f(t);return(0,L.jsxs)("div",{className:"product-card",children:[(0,L.jsxs)("div",{className:"product-header",children:[(0,L.jsx)("div",{className:"product-icon",style:{background:b(t)},children:(0,L.jsx)(s,{size:24,className:"text-white"})}),(0,L.jsxs)("div",{className:"product-info",children:[(0,L.jsx)("h3",{className:"product-name",children:a.displayName||t}),(0,L.jsx)("div",{className:"product-meta",children:(0,L.jsxs)("span",{className:"agents-count",children:[(0,L.jsx)(ge.A,{size:14}),a.agents," agenti"]})})]})]}),(0,L.jsx)("div",{className:"product-metrics",children:(0,L.jsxs)("div",{className:"metric-row",children:[(0,L.jsxs)("div",{className:"metric-item",children:[(0,L.jsx)("span",{className:"metric-label",children:"Volume"}),(0,L.jsx)("span",{className:"metric-value volume",children:Qe(a.volume)})]}),a.fatturato>0&&(0,L.jsxs)("div",{className:"metric-item",children:[(0,L.jsx)("span",{className:"metric-label",children:"Fatturato"}),(0,L.jsx)("span",{className:"metric-value revenue",children:Ze(a.fatturato)})]})]})}),(0,L.jsxs)("div",{className:"top-agents",children:[(0,L.jsx)("span",{className:"top-agents-label",children:"Top Performer:"}),(0,L.jsx)("div",{className:"agents-list",children:a.topAgents.slice(0,2).map((e,t)=>(0,L.jsxs)("span",{className:"agent-badge ".concat(0===t?"gold":"silver"),children:[0===t&&"ðŸ¥‡"," ",e.split(" ")[0]]},e))})]})]},t)}):(0,L.jsxs)("div",{className:"no-products",children:[(0,L.jsx)(W.A,{size:48,className:"opacity-30"}),(0,L.jsx)("h3",{children:"Nessun prodotto trovato"}),(0,L.jsx)("p",{children:"Modifica i filtri o carica nuovi dati per visualizzare i prodotti."})]})}),"table"===l&&(0,L.jsx)("div",{className:"products-table-container",children:(0,L.jsx)("div",{className:"table-wrapper",children:(0,L.jsxs)("table",{className:"products-table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Prodotto"}),(0,L.jsx)("th",{children:"Volume"}),(0,L.jsx)("th",{children:"Fatturato"}),(0,L.jsx)("th",{children:"Agenti"}),(0,L.jsx)("th",{children:"Top Performer"})]})}),(0,L.jsx)("tbody",{children:j.map((e,t)=>{var a;let[s,n]=e;const i=f(s);return(0,L.jsxs)("tr",{className:"product-row",children:[(0,L.jsx)("td",{className:"product-cell",children:(0,L.jsxs)("div",{className:"product-info-table",children:[(0,L.jsx)("div",{className:"product-icon-small",style:{background:b(s)},children:(0,L.jsx)(i,{size:16,className:"text-white"})}),(0,L.jsx)("span",{className:"product-name-table",children:n.displayName||s})]})}),(0,L.jsx)("td",{className:"volume-cell",children:Qe(n.volume)}),(0,L.jsx)("td",{className:"revenue-cell",children:n.fatturato>0?Ze(n.fatturato):"-"}),(0,L.jsx)("td",{className:"agents-cell",children:n.agents}),(0,L.jsx)("td",{className:"top-agent-cell",children:(null===(a=n.topAgents[0])||void 0===a?void 0:a.split(" ")[0])||"-"})]},s)})})]})})}),"chart"===l&&(0,L.jsxs)("div",{className:"charts-container-real",children:[(0,L.jsxs)("div",{className:"chart-controls",children:[(0,L.jsxs)("div",{className:"chart-type-selector",children:[(0,L.jsx)("label",{children:"Tipo Grafico:"}),(0,L.jsxs)("select",{value:c,onChange:e=>d(e.target.value),children:[(0,L.jsx)("option",{value:"pie",children:"Grafico a Torta"}),(0,L.jsx)("option",{value:"bar",children:"Grafico a Barre"}),(0,L.jsx)("option",{value:"line",children:"Grafico Lineare"}),(0,L.jsx)("option",{value:"area",children:"Grafico ad Area"})]})]}),(0,L.jsxs)("div",{className:"chart-metric-selector",children:[(0,L.jsx)("label",{children:"Metrica:"}),(0,L.jsxs)("select",{value:u,onChange:e=>m(e.target.value),children:[(0,L.jsx)("option",{value:"fatturato",children:"Fatturato"}),(0,L.jsx)("option",{value:"volume",children:"Volume"}),(0,L.jsx)("option",{value:"agents",children:"NÂ° Agenti"})]})]})]}),y&&0!==y.length?(0,L.jsx)("div",{className:"charts-grid",children:(0,L.jsxs)("div",{className:"main-chart-card",children:[(0,L.jsx)("div",{className:"chart-header",children:(0,L.jsxs)("h3",{children:["Distribuzione per ",u]})}),(0,L.jsx)("div",{className:"chart-wrapper",style:{width:"100%",height:"400px"},children:(0,L.jsx)(Z.u,{children:"pie"===c?(0,L.jsxs)(Ue.r,{children:[(0,L.jsx)(Me.F,{data:y,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:120,label:e=>{let{value:t}=e;return A(t,{includeUnit:"agents"===u})},labelLine:!1,children:y.map((e,t)=>(0,L.jsx)(_e.f,{fill:h[t%h.length]},"cell-".concat(t)))}),(0,L.jsx)(te.m,{formatter:e=>A(e,{includeUnit:"agents"===u})}),(0,L.jsx)(ae.s,{})]}):"bar"===c?(0,L.jsxs)(Le.E,{data:y,children:[(0,L.jsx)($.d,{strokeDasharray:"3 3"}),(0,L.jsx)(X.W,{dataKey:"name",angle:-25,textAnchor:"end",height:80,interval:0,fontSize:10}),(0,L.jsx)(ee.h,{tickFormatter:e=>A(e)}),(0,L.jsx)(te.m,{formatter:e=>A(e,{includeUnit:"agents"===u})}),(0,L.jsx)(ae.s,{}),(0,L.jsxs)(qe.y,{dataKey:"value",children:[(0,L.jsx)(Be.Z,{dataKey:"value",position:"top",formatter:e=>A(e,{includeUnit:"agents"===u})}),y.map((e,t)=>(0,L.jsx)(_e.f,{fill:h[t%h.length]},"cell-".concat(t)))]})]}):"line"===c?(0,L.jsxs)(Q.b,{data:y,children:[(0,L.jsx)($.d,{strokeDasharray:"3 3"}),(0,L.jsx)(X.W,{dataKey:"name"}),(0,L.jsx)(ee.h,{tickFormatter:e=>A(e)}),(0,L.jsx)(te.m,{formatter:e=>A(e,{includeUnit:"agents"===u})}),(0,L.jsx)(ae.s,{}),(0,L.jsx)(se.N,{type:"monotone",dataKey:"value",stroke:h[0],children:(0,L.jsx)(Be.Z,{dataKey:"value",position:"top",formatter:e=>A(e,{includeUnit:"agents"===u})})})]}):(0,L.jsxs)(Ve.Q,{data:y,children:[(0,L.jsx)($.d,{strokeDasharray:"3 3"}),(0,L.jsx)(X.W,{dataKey:"name"}),(0,L.jsx)(ee.h,{tickFormatter:e=>A(e)}),(0,L.jsx)(te.m,{formatter:e=>A(e,{includeUnit:"agents"===u})}),(0,L.jsx)(ae.s,{}),(0,L.jsx)(Ge.Gk,{type:"monotone",dataKey:"value",stroke:h[0],fill:h[0],fillOpacity:.3,children:(0,L.jsx)(Be.Z,{dataKey:"value",position:"top",formatter:e=>A(e,{includeUnit:"agents"===u})})})]})})})]})}):(0,L.jsxs)("div",{className:"no-chart-data",children:[(0,L.jsx)(W.A,{size:48,className:"opacity-30"}),(0,L.jsx)("h3",{children:"âš ï¸ NESSUN DATO PER I GRAFICI"}),(0,L.jsx)("p",{children:"Prova a cambiare file, filtri, o controlla che i dati siano stati caricati correttamente."})]})]})]})};var Xe=a(1999),et=a(6192),tt=a(5300),at=a(1393),st=a(3241),nt=a(6632),it=a(2201);function rt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function lt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(a),!0).forEach(function(t){ot(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rt(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function ot(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const ct=e=>{let{agent:t}=e;const a=(s=t.nuovoCliente)>=5?"high":s>=2?"medium":"low";var s;const n=t.nome.split(" ").map(e=>e[0]).join("").substring(0,2);return(0,L.jsxs)("div",{className:"new-client-card ".concat(a),children:[(0,L.jsxs)("div",{className:"card-header ".concat(a),children:[(0,L.jsx)("div",{className:"avatar",children:n}),(0,L.jsxs)("div",{className:"agent-info",children:[(0,L.jsx)("h3",{className:"agent-name",children:t.nome}),(0,L.jsx)("p",{className:"agent-sm",children:t.sm})]}),(0,L.jsxs)("div",{className:"performance-badge",children:[(0,L.jsx)("span",{className:"new-clients-count",children:E(t.nuovoCliente)}),(0,L.jsx)(Xe.A,{size:20})]})]}),(0,L.jsxs)("div",{className:"card-body",children:[(0,L.jsxs)("div",{className:"stats-grid",children:[(0,L.jsxs)("div",{className:"stat-item highlight",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(G.A,{size:20})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-label",children:"Fatturato Nuovi Clienti"}),(0,L.jsx)("span",{className:"stat-value primary",children:z(t.fatturatoNuovoCliente)})]})]}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(Y.A,{size:20})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-label",children:"Fatturato Rush"}),(0,L.jsx)("span",{className:"stat-value",children:z(t.fatturatoRush)})]})]})]}),(0,L.jsxs)("div",{className:"acquisition-channels",children:[(0,L.jsx)("h5",{children:"Canali Acquisizione"}),(0,L.jsxs)("div",{className:"channels-grid",children:[(0,L.jsxs)("div",{className:"channel-item",children:[(0,L.jsx)("span",{className:"channel-name",children:"Diretto"}),(0,L.jsx)("span",{className:"channel-value",children:"-"})]}),(0,L.jsxs)("div",{className:"channel-item",children:[(0,L.jsx)("span",{className:"channel-name",children:"Referral"}),(0,L.jsx)("span",{className:"channel-value",children:"-"})]}),(0,L.jsxs)("div",{className:"channel-item",children:[(0,L.jsx)("span",{className:"channel-name",children:"Altro"}),(0,L.jsx)("span",{className:"channel-value",children:"-"})]})]})]})]}),(0,L.jsx)("div",{className:"card-footer",children:(0,L.jsxs)("div",{className:"performance-indicator",children:[(0,L.jsx)("div",{className:"indicator-dot ".concat(a)}),(0,L.jsxs)("span",{className:"performance-text",children:["Performance: ",a.charAt(0).toUpperCase()+a.slice(1)]})]})})]})},dt=e=>{let{agent:t,rank:a}=e;const s="rank-".concat(a);return(0,L.jsxs)("div",{className:"performer-card ".concat(s),children:[(0,L.jsx)("div",{className:"performer-rank",children:a}),(0,L.jsxs)("div",{className:"performer-info",children:[(0,L.jsx)("h4",{children:t.nome}),(0,L.jsx)("p",{className:"performer-sm",children:t.sm})]}),(0,L.jsxs)("div",{className:"performer-stats",children:[(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)(Xe.A,{size:16})," ",(0,L.jsx)("strong",{children:E(t.nuovoCliente)})," Clienti"]}),(0,L.jsxs)("div",{className:"stat-item primary",children:[(0,L.jsx)(G.A,{size:16})," ",(0,L.jsx)("strong",{children:z(t.fatturatoNuovoCliente)})," Fatturato"]})]})]})},ut=()=>{const{data:e,selectedFileDate:t,loadFiles:a,globalLoading:n}=na(),[i,r]=(0,s.useState)(!1),[l,o]=(0,s.useState)({searchTerm:"",selectedSm:""}),[c,d]=(0,s.useState)({by:"nuovoCliente",order:"desc"}),{agents:u,smList:m,stats:h,topPerformers:p,allAgentsInPeriod:x}=(0,s.useMemo)(()=>{const a={agents:[],smList:[],stats:{totalClients:0,totalRevenue:0,avgClientsPerAgent:0,topSm:{name:"N/A",clients:0}},topPerformers:[],allAgentsInPeriod:[]};if(!t||!e.uploadedFiles||0===e.uploadedFiles.length)return a;const s=e.uploadedFiles.find(e=>e.date===t);if(!s||!s.data||!s.data.agents)return a;const n=s.data.agents.map((e,t)=>lt(lt({},e),{},{id:"".concat(s.date,"-").concat(e.nome,"-").concat(t),nome:B(e.nome)})),i=[...new Set(n.map(e=>e.sm).filter(Boolean))].sort();let r=n.filter(e=>e.nome.toLowerCase().includes(l.searchTerm.toLowerCase())&&(""===l.selectedSm||e.sm===l.selectedSm));r.sort((e,t)=>{const a=e[c.by]||0,s=t[c.by]||0;return"asc"===c.order?a-s:s-a});const o=r.reduce((e,t)=>e+(t.nuovoCliente||0),0),d=r.reduce((e,t)=>e+(t.fatturatoNuovoCliente||0),0),u=r.length>0?o/r.length:0,m=n.reduce((e,t)=>(e[t.sm]=(e[t.sm]||0)+(t.nuovoCliente||0),e),{}),h=Object.entries(m).sort((e,t)=>t[1]-e[1])[0];return{agents:r,smList:i,stats:{totalClients:o,totalRevenue:d,avgClientsPerAgent:u,topSm:h?{name:h[0],clients:h[1]}:{name:"N/A",clients:0}},topPerformers:[...n].filter(e=>e.nuovoCliente>0).sort((e,t)=>(t.nuovoCliente||0)-(e.nuovoCliente||0)).slice(0,3),allAgentsInPeriod:n}},[e.uploadedFiles,t,l,c]),v=(e,t)=>o(a=>lt(lt({},a),{},{[e]:t})),j=e=>d(t=>lt(lt({},t),{},{by:e,order:t.by===e&&"desc"===t.order?"asc":"desc"}));return n&&!h.totalClients?(0,L.jsxs)("div",{className:"modern-new-clients-loading",children:[(0,L.jsx)("div",{className:"loading-spinner"}),(0,L.jsx)("p",{children:"Analizzando i dati di acquisizione..."})]}):t&&e.processedData[t]?(0,L.jsxs)("div",{className:"modern-new-clients-container",children:[(0,L.jsxs)("div",{className:"page-header",children:[(0,L.jsxs)("div",{className:"header-content",children:[(0,L.jsxs)("div",{className:"header-text",children:[(0,L.jsxs)("h1",{className:"page-title",children:[(0,L.jsx)(Xe.A,{size:32})," Acquisizione Nuovi Clienti"]}),(0,L.jsx)("p",{className:"page-subtitle",children:"Analisi delle performance di acquisizione della rete vendita."})]}),(0,L.jsxs)("button",{className:"refresh-btn ".concat(i||n?"refreshing":""),onClick:async()=>{r(!0),await a(),r(!1)},disabled:i||n,children:[(0,L.jsx)(fe.A,{size:20})," ",i||n?"Aggiornamento...":"Aggiorna Dati"]})]}),(0,L.jsxs)("div",{className:"header-stats",children:[(0,L.jsxs)("div",{className:"stat-card primary",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(et.A,{size:24})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:E(h.totalClients)}),(0,L.jsx)("span",{className:"stat-label",children:"Clienti Acquisiti"})]})]}),(0,L.jsxs)("div",{className:"stat-card success",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(G.A,{size:24})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:z(h.totalRevenue)}),(0,L.jsx)("span",{className:"stat-label",children:"Fatturato da Nuovi Clienti"})]})]}),(0,L.jsxs)("div",{className:"stat-card accent",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(tt.A,{size:24})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:h.avgClientsPerAgent.toFixed(1)}),(0,L.jsx)("span",{className:"stat-label",children:"Media Clienti / Agente"})]})]}),(0,L.jsxs)("div",{className:"stat-card info",children:[(0,L.jsx)("div",{className:"stat-icon",children:(0,L.jsx)(at.A,{size:24})}),(0,L.jsxs)("div",{className:"stat-content",children:[(0,L.jsx)("span",{className:"stat-value",children:B(h.topSm.name)}),(0,L.jsxs)("span",{className:"stat-label",children:["Top Coordinatore (",E(h.topSm.clients)," clienti)"]})]})]})]})]}),p.length>0&&(0,L.jsxs)("div",{className:"top-performers-section",children:[(0,L.jsxs)("h2",{className:"section-title",children:[(0,L.jsx)(Oe.A,{size:24})," Top Performers"]}),(0,L.jsx)("div",{className:"performers-grid",children:p.map((e,t)=>(0,L.jsx)(dt,{agent:e,rank:t+1},e.id))})]}),(0,L.jsxs)("div",{className:"filters-modern",children:[(0,L.jsxs)("div",{className:"filters-header",children:[(0,L.jsxs)("div",{className:"filters-title",children:[(0,L.jsx)(be.A,{size:20}),"Filtri Agenti"]}),(0,L.jsxs)("div",{className:"results-count",children:[u.length," di ",x.length," agenti"]})]}),(0,L.jsxs)("div",{className:"filters-grid",children:[(0,L.jsxs)("div",{className:"filter-group",children:[(0,L.jsxs)("label",{className:"filter-label",children:[(0,L.jsx)(Ne.A,{size:16})," Cerca Agente"]}),(0,L.jsx)("input",{type:"text",placeholder:"Nome agente...",value:l.searchTerm,onChange:e=>v("searchTerm",e.target.value),className:"modern-search-input"})]}),(0,L.jsxs)("div",{className:"filter-group",children:[(0,L.jsxs)("label",{className:"filter-label",children:[(0,L.jsx)(ge.A,{size:16})," Filtra per Coordinatore"]}),(0,L.jsxs)("select",{value:l.selectedSm,onChange:e=>v("selectedSm",e.target.value),className:"modern-select",children:[(0,L.jsx)("option",{value:"",children:"Tutti i Coordinatori"}),m.map(e=>(0,L.jsx)("option",{value:e,children:e},e))]})]}),(0,L.jsxs)("div",{className:"filter-group",children:[(0,L.jsx)("label",{className:"filter-label",children:"Ordina Per"}),(0,L.jsxs)("div",{className:"sort-controls",children:[(0,L.jsxs)("select",{value:c.by,onChange:e=>j(e.target.value),className:"modern-select",children:[(0,L.jsx)("option",{value:"nuovoCliente",children:"Nuovi Clienti"}),(0,L.jsx)("option",{value:"fatturatoNuovoCliente",children:"Fatturato NC"}),(0,L.jsx)("option",{value:"fatturatoRush",children:"Fatturato Rush"})]}),(0,L.jsx)("button",{className:"sort-order-btn",onClick:()=>j(c.by),children:"desc"===c.order?(0,L.jsx)(st.A,{size:16}):(0,L.jsx)(nt.A,{size:16})})]})]}),(0,L.jsxs)("div",{className:"filter-group",children:[(0,L.jsx)("label",{className:"filter-label",children:"Â "}),(0,L.jsx)("button",{className:"reset-filters-btn",onClick:()=>{o({searchTerm:"",selectedSm:""}),d({by:"nuovoCliente",order:"desc"})},children:"Reset Filtri"})]})]})]}),(0,L.jsxs)("div",{className:"agents-section",children:[(0,L.jsxs)("h2",{className:"section-title",children:[(0,L.jsx)(it.A,{size:24})," Dettaglio Agenti"]}),(0,L.jsx)("div",{className:"agents-grid-modern ".concat(n?"loading":""),children:u.length>0?u.map(e=>(0,L.jsx)(ct,{agent:e},e.id)):(0,L.jsxs)("div",{className:"no-results-modern",children:[(0,L.jsx)("div",{className:"no-results-icon",children:(0,L.jsx)(Ne.A,{size:48})}),(0,L.jsx)("h3",{children:"Nessun agente trovato"}),(0,L.jsx)("p",{children:"Prova a modificare i filtri per visualizzare piÃ¹ risultati."})]})})]})]}):(0,L.jsxs)("div",{className:"modern-new-clients-loading",children:[(0,L.jsx)("h3",{children:"Nessun file selezionato"}),(0,L.jsx)("p",{children:'Per favore, vai alla sezione "Gestione File" e seleziona un periodo da analizzare.'})]})};var mt=a(693),ht=a(3160),pt=a(7623);function xt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function vt(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const jt=e=>new Intl.NumberFormat("it-IT").format(e||0),gt=()=>{const{data:e,selectedFileDate:t,globalLoading:a,loadFiles:n}=na(),[i,r]=(0,s.useState)("overview"),[l,o]=(0,s.useState)(!1),c=(0,s.useMemo)(()=>{var a;if(!e.uploadedFiles||0===e.uploadedFiles.length)return null;const s=t?e.uploadedFiles.find(e=>e.date===t):e.uploadedFiles[0];if(null==s||null===(a=s.data)||void 0===a||!a.agents)return null;const n=s.data.agents.filter(e=>(e.fastwebEnergia||0)>0);if(0===n.length)return{totalContracts:0,totalAgents:0,avgContracts:0,topAgent:null,topSm:null,agents:[],smRanking:[],period:s.displayDate};const i=n.reduce((e,t)=>e+t.fastwebEnergia,0),r=n.reduce((e,t)=>t.fastwebEnergia>e.fastwebEnergia?t:e,n[0]),l=new Map;n.forEach(e=>{if(!e.sm)return;const t=B(e.sm),a=l.get(t)||{contracts:0,agents:0,agentList:[]};a.contracts+=e.fastwebEnergia,a.agents+=1,a.agentList.push({name:B(e.nome),contracts:e.fastwebEnergia}),l.set(t,a)});const o=Array.from(l.entries()).map(e=>{let[t,a]=e;return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(a),!0).forEach(function(t){vt(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xt(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({name:t},a)}).sort((e,t)=>t.contracts-e.contracts),c=o.length>0?o[0]:null;return{totalContracts:i,totalAgents:n.length,avgContracts:i/n.length,topAgent:r,topSm:c,agents:n.sort((e,t)=>t.fastwebEnergia-e.fastwebEnergia),smRanking:o,period:s.displayDate}},[e,t]);if(a)return(0,L.jsxs)("div",{className:"modern-fastweb-loading",children:[(0,L.jsx)("div",{className:"loading-spinner"}),(0,L.jsx)("p",{children:"Caricamento dati Fastweb..."})]});if(!c)return(0,L.jsx)("div",{className:"modern-fastweb-container",children:(0,L.jsxs)("div",{className:"no-results",style:{gridColumn:"1 / -1"},children:[(0,L.jsx)(mt.A,{size:64}),(0,L.jsx)("h3",{children:"Nessun dato Fastweb disponibile"}),(0,L.jsx)("p",{children:"Carica un file per visualizzare le statistiche dei contratti Fastweb."})]})});const{totalContracts:d,totalAgents:u,avgContracts:m,topAgent:h,topSm:p,agents:x,smRanking:v,period:j}=c;return(0,L.jsxs)("div",{className:"modern-fastweb-container",children:[(0,L.jsxs)("header",{className:"page-header fastweb-theme",children:[(0,L.jsxs)("div",{className:"header-content",children:[(0,L.jsxs)("div",{className:"header-text",children:[(0,L.jsxs)("h1",{className:"page-title",children:[(0,L.jsx)(he.A,{})," Analisi Fastweb"]}),(0,L.jsxs)("p",{className:"page-subtitle",children:["Dettaglio e performance dei contratti Fastweb Energia per il periodo: ",(0,L.jsx)("strong",{children:j||"N/A"})]})]}),(0,L.jsx)("div",{className:"header-actions",children:(0,L.jsxs)("button",{onClick:async()=>{o(!0),await n(),setTimeout(()=>o(!1),500)},disabled:l,className:"refresh-btn ".concat(l?"refreshing":""),children:[(0,L.jsx)(fe.A,{size:18}),(0,L.jsx)("span",{children:l?"Aggiornando...":"Aggiorna Dati"})]})})]}),(0,L.jsxs)("div",{className:"kpi-grid",children:[(0,L.jsxs)("div",{className:"kpi-card primary",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(he.A,{size:28})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("div",{className:"kpi-value",children:jt(d)}),(0,L.jsx)("div",{className:"kpi-label",children:"Contratti Totali"})]})]}),(0,L.jsxs)("div",{className:"kpi-card success",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(ge.A,{size:28})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("div",{className:"kpi-value",children:jt(u)}),(0,L.jsx)("div",{className:"kpi-label",children:"Agenti con Contratti"})]})]}),(0,L.jsxs)("div",{className:"kpi-card accent",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(tt.A,{size:28})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("div",{className:"kpi-value",children:jt(m.toFixed(2))}),(0,L.jsx)("div",{className:"kpi-label",children:"Media Contratti/Agente"})]})]}),(0,L.jsxs)("div",{className:"kpi-card info",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(K.A,{size:28})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("div",{className:"kpi-value",children:h?B(h.nome):"N/A"}),(0,L.jsx)("div",{className:"kpi-label",children:"Top Performer"})]})]})]})]}),(0,L.jsxs)("div",{className:"view-tabs",children:[(0,L.jsxs)("button",{className:"tab-btn ".concat("overview"===i?"active":""),onClick:()=>r("overview"),children:[(0,L.jsx)(ht.A,{size:18})," Overview"]}),(0,L.jsxs)("button",{className:"tab-btn ".concat("agents"===i?"active":""),onClick:()=>r("agents"),children:[(0,L.jsx)(pt.A,{size:18})," Lista Agenti"]})]}),"overview"===i?(0,L.jsxs)("div",{className:"overview-section",children:[(0,L.jsxs)("div",{className:"section-card",children:[(0,L.jsxs)("div",{className:"section-header",children:[(0,L.jsxs)("h3",{children:[(0,L.jsx)(Re.A,{size:20})," Top Performers"]}),(0,L.jsx)("span",{className:"badge-live",children:"Live"})]}),(0,L.jsxs)("div",{className:"performers-list",children:[h?(0,L.jsxs)("div",{className:"performer-item rank-1",children:[(0,L.jsx)("div",{className:"performer-rank",children:"1"}),(0,L.jsxs)("div",{className:"performer-info",children:[(0,L.jsx)("h4",{children:B(h.nome)}),(0,L.jsx)("p",{children:"Miglior Agente"})]}),(0,L.jsx)("div",{className:"performer-stats",children:(0,L.jsxs)("div",{className:"stat-item primary",children:[(0,L.jsx)(he.A,{size:14}),(0,L.jsx)("strong",{children:jt(h.fastwebEnergia)})," contratti"]})})]}):(0,L.jsx)("p",{children:"Nessun agente con contratti Fastweb."}),p?(0,L.jsxs)("div",{className:"performer-item rank-2",children:[(0,L.jsx)("div",{className:"performer-rank",children:"1"}),(0,L.jsxs)("div",{className:"performer-info",children:[(0,L.jsx)("h4",{children:p.name}),(0,L.jsx)("p",{children:"Miglior SM"})]}),(0,L.jsx)("div",{className:"performer-stats",children:(0,L.jsxs)("div",{className:"stat-item primary",children:[(0,L.jsx)(he.A,{size:14}),(0,L.jsx)("strong",{children:jt(p.contracts)})," contratti"]})})]}):(0,L.jsx)("p",{children:"Nessun SM con contratti Fastweb."})]})]}),(0,L.jsxs)("div",{className:"section-card",children:[(0,L.jsx)("div",{className:"section-header",children:(0,L.jsxs)("h3",{children:[(0,L.jsx)(at.A,{size:20})," Classifica Sales Manager"]})}),(0,L.jsx)("div",{className:"sm-rankings-grid",children:v.slice(0,4).map((e,t)=>(0,L.jsxs)("div",{className:"sm-card ".concat(0===t?"rank-1":""),children:[0===t&&(0,L.jsx)("div",{className:"sm-rank",children:"ðŸ†"}),(0,L.jsx)("div",{className:"sm-info",children:(0,L.jsx)("h4",{children:e.name})}),(0,L.jsxs)("div",{className:"sm-metrics",children:[(0,L.jsxs)("div",{className:"metric",children:[(0,L.jsx)("span",{className:"metric-value",children:jt(e.contracts)}),(0,L.jsx)("span",{className:"metric-label",children:"Contratti"})]}),(0,L.jsxs)("div",{className:"metric",children:[(0,L.jsx)("span",{className:"metric-value",children:jt(e.agents)}),(0,L.jsx)("span",{className:"metric-label",children:"Agenti"})]})]})]},e.name))})]})]}):(0,L.jsx)("div",{className:"agents-section",children:(0,L.jsx)("div",{className:"agents-grid",children:x.length>0?x.map(e=>(0,L.jsx)("div",{className:"fastweb-agent-card low",children:(0,L.jsxs)("div",{className:"card-header",children:[(0,L.jsx)("div",{className:"agent-avatar",children:B(e.nome).charAt(0)}),(0,L.jsxs)("div",{className:"agent-info",children:[(0,L.jsx)("h4",{children:B(e.nome)}),(0,L.jsx)("p",{children:B(e.sm)})]}),(0,L.jsxs)("div",{className:"contracts-badge",children:[(0,L.jsx)(he.A,{size:16}),(0,L.jsx)("span",{children:jt(e.fastwebEnergia)})]})]})},e.id)):(0,L.jsxs)("div",{className:"no-results",children:[(0,L.jsx)(mt.A,{size:48}),(0,L.jsx)("h3",{children:"Nessun agente trovato"}),(0,L.jsx)("p",{children:"Nessun agente ha contratti Fastweb in questo periodo."})]})})})]})};var ft=a(1429),bt=a(10),Nt=a(827),At=a(85),yt=a(3598);const wt=e=>new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(e||0),kt=e=>new Intl.NumberFormat("it-IT").format(e||0),Ct=e=>"".concat(e.toFixed(1),"%"),St=e=>{let{value:t,text:a="vs. mese prec."}=e;if(null===t||isNaN(t))return null;const s=t>0,n=t<0;let i="neutral";return s&&(i="positive"),n&&(i="negative"),(0,L.jsxs)("span",{className:"kpi-trend ".concat(i),children:[s&&(0,L.jsx)(Y.A,{size:14}),n&&(0,L.jsx)(ft.A,{size:14}),Ct(t)," ",a]})},Rt=e=>{let{insight:t}=e;const{icon:a,type:s,title:n,text:i}=t;return(0,L.jsxs)("div",{className:"insight-card ".concat(s),children:[(0,L.jsx)("div",{className:"insight-icon",children:(0,L.jsx)(a,{size:24})}),(0,L.jsxs)("div",{className:"insight-content",children:[(0,L.jsx)("h4",{children:n}),(0,L.jsx)("p",{children:i})]})]})},Ot=e=>{let{active:t,payload:a,label:s}=e;if(t&&a&&a.length){const e=a[0];return(0,L.jsxs)("div",{className:"custom-chart-tooltip",children:[(0,L.jsx)("p",{className:"tooltip-label",children:s}),(0,L.jsx)("p",{style:{color:e.color},children:"".concat(e.name,": ").concat(wt(e.value))})]})}return null},Ft=e=>{let{title:t,value:a,icon:s}=e;const n=a>0?"up":a<0?"down":"neutral";return(0,L.jsxs)("div",{className:"trend-card ".concat(n),children:[(0,L.jsxs)("div",{className:"trend-header",children:[(0,L.jsx)("h4",{children:t}),(0,L.jsx)(s,{size:20})]}),(0,L.jsxs)("div",{className:"trend-content",children:[(0,L.jsx)("div",{className:"trend-percentage",children:Ct(a)}),(0,L.jsx)("div",{className:"trend-description",children:"Rispetto al mese precedente"})]})]})},Tt=e=>{let{setActiveSection:t}=e;const{data:a}=na(),[n,i]=(0,s.useState)(!1),r=a&&a.uploadedFiles&&a.uploadedFiles.length>1,[l,o]=(0,s.useState)("overview"),[c,d]=(0,s.useState)("Fatturato Rush"),u=(0,s.useMemo)(()=>{var e,t;if(!r)return null;const s=a.uploadedFiles.slice(0,6).reverse(),n=s.map(e=>({name:e.displayDate,"Fatturato Totale":e.metadata.totalRevenue,"Fatturato Rush":e.metadata.totalRush,"Nuovi Clienti":e.metadata.totalNewClients,"Agenti Attivi":e.metadata.totalAgents})),i=(null===(e=s[s.length-1])||void 0===e?void 0:e.metadata)||{},l=(null===(t=s[s.length-2])||void 0===t?void 0:t.metadata)||{},o=(e,t)=>0===t?e>0?100:0:(e-t)/t*100,c=o(i.totalRevenue,l.totalRevenue),d=s.reduce((e,t)=>e+t.metadata.totalRevenue,0)/s.length,u=o(i.totalNewClients,l.totalNewClients),m=s.reduce((e,t)=>t.metadata.totalRevenue>e.metadata.totalRevenue?t:e),h={headers:s.map(e=>e.displayDate),rows:[{metric:"Fatturato Totale",values:s.map(e=>wt(e.metadata.totalRevenue))},{metric:"Fatturato Rush",values:s.map(e=>wt(e.metadata.totalRush))},{metric:"Nuovi Clienti",values:s.map(e=>kt(e.metadata.totalNewClients))},{metric:"Agenti Attivi",values:s.map(e=>kt(e.metadata.totalAgents))}]},p=s.reduce((e,t)=>e+t.metadata.totalRevenue,0),x=s.reduce((e,t)=>e+t.metadata.totalRush,0),v=s.reduce((e,t)=>e+t.metadata.totalNewClients,0),j=s.reduce((e,t)=>e+t.metadata.totalAgents,0)/s.length;return{monthlyData:n,comparisonData:h,kpis:{revenueTrend:c,averageRevenue:d,clientTrend:u,bestMonth:{date:m.displayDate,revenue:m.metadata.totalRevenue}},summary:{totalRevenue:p,totalRush:x,totalNewClients:v,averageAgents:j},trends:{revenue:c,rush:o(i.totalRush,l.totalRush),clients:u,agents:o(i.totalAgents,l.totalAgents)},insights:[{type:"success",icon:Y.A,title:"Miglior Mese",text:"Il mese con il fatturato piÃ¹ alto Ã¨ stato ".concat(m.displayDate," con un totale di ").concat(wt(m.metadata.totalRevenue),".")},{type:"info",icon:bt.A,title:"Performance Fatturato",text:"Il fatturato totale dell'ultimo mese Ã¨ in ".concat(c>0?"crescita":"calo"," del ").concat(Ct(Math.abs(c))," rispetto al precedente.")},{type:"warning",icon:ge.A,title:"Andamento Clienti",text:"Nell'ultimo mese, il numero di nuovi clienti Ã¨ in ".concat(u>0?"crescita":"calo"," del ").concat(Ct(Math.abs(u)),".")}]}},[a,r]),m=()=>(0,L.jsxs)("div",{className:"historical-loading",children:[(0,L.jsx)("div",{className:"loading-spinner"}),(0,L.jsx)("p",{children:"Caricamento dati storici..."})]}),h=e=>{let{setActiveSection:t}=e;return(0,L.jsxs)("div",{className:"historical-no-data",children:[(0,L.jsx)(Nt.A,{size:64}),(0,L.jsx)("h2",{children:"Nessun Dato Storico Disponibile"}),(0,L.jsx)("p",{children:"Non sono stati ancora caricati file sufficienti per un'analisi storica."}),(0,L.jsx)("p",{children:"Carica i file mensili per abilitare questa funzionalitÃ ."}),(0,L.jsx)("button",{className:"upload-more-btn",onClick:()=>t("files"),children:"Vai a Gestione File"})]})};return n?(0,L.jsx)("div",{className:"modern-historical-container",children:(0,L.jsx)(m,{})}):r?(0,L.jsxs)("div",{className:"modern-historical-container",children:[(0,L.jsx)("header",{className:"page-header historical-theme",children:(0,L.jsxs)("div",{className:"header-content",children:[(0,L.jsxs)("div",{className:"header-text",children:[(0,L.jsxs)("h1",{className:"page-title",children:[(0,L.jsx)(At.A,{size:40}),"Analisi Storica"]}),(0,L.jsx)("p",{className:"page-subtitle",children:"Confronta le performance e scopri i trend nel tempo."})]}),(0,L.jsxs)("div",{className:"header-actions",children:[(0,L.jsx)("div",{className:"period-selector",children:(0,L.jsxs)("select",{className:"period-select",children:[(0,L.jsx)("option",{children:"Ultimi 6 mesi"}),(0,L.jsx)("option",{children:"Ultimi 12 mesi"}),(0,L.jsx)("option",{children:"Anno Corrente"}),(0,L.jsx)("option",{children:"Anno Precedente"})]})}),(0,L.jsxs)("button",{className:"refresh-btn",onClick:()=>{i(!0),setTimeout(()=>{i(!1)},2e3)},disabled:n,children:[(0,L.jsx)(fe.A,{size:16,className:n?"animate-spin":""}),"Aggiorna"]})]})]})}),(0,L.jsxs)("section",{className:"historical-kpis",children:[(0,L.jsxs)("div",{className:"kpi-card trend-positive",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(Y.A,{size:24})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("div",{className:"kpi-value",children:Ct(u.kpis.revenueTrend)}),(0,L.jsx)("div",{className:"kpi-label",children:"Trend Fatturato"}),(0,L.jsx)(St,{value:u.kpis.revenueTrend})]})]}),(0,L.jsxs)("div",{className:"kpi-card trend-revenue",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(bt.A,{size:24})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("div",{className:"kpi-value",children:wt(u.kpis.averageRevenue)}),(0,L.jsx)("div",{className:"kpi-label",children:"Fatturato Medio Mensile"})]})]}),(0,L.jsxs)("div",{className:"kpi-card trend-growth",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(ge.A,{size:24})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("div",{className:"kpi-value",children:Ct(u.kpis.clientTrend)}),(0,L.jsx)("div",{className:"kpi-label",children:"Trend Clienti"}),(0,L.jsx)(St,{value:u.kpis.clientTrend})]})]}),(0,L.jsxs)("div",{className:"kpi-card trend-insights",children:[(0,L.jsx)("div",{className:"kpi-icon",children:(0,L.jsx)(yt.A,{size:24})}),(0,L.jsxs)("div",{className:"kpi-content",children:[(0,L.jsx)("div",{className:"kpi-value",children:u.kpis.bestMonth.date}),(0,L.jsx)("div",{className:"kpi-label",children:"Miglior Mese (Fatt.)"}),(0,L.jsx)("span",{className:"kpi-trend",children:wt(u.kpis.bestMonth.revenue)})]})]})]}),(0,L.jsxs)("div",{className:"view-tabs",children:[(0,L.jsxs)("button",{className:"tab-btn ".concat("overview"===l?"active":""),onClick:()=>o("overview"),children:[(0,L.jsx)(bt.A,{size:18}),"Panoramica"]}),(0,L.jsxs)("button",{className:"tab-btn ".concat("trends"===l?"active":""),onClick:()=>o("trends"),children:[(0,L.jsx)(Y.A,{size:18}),"Trends"]}),(0,L.jsxs)("button",{className:"tab-btn ".concat("comparison"===l?"active":""),onClick:()=>o("comparison"),children:[(0,L.jsx)(Nt.A,{size:18}),"Confronto"]}),(0,L.jsxs)("button",{className:"tab-btn ".concat("insights"===l?"active":""),onClick:()=>o("insights"),children:[(0,L.jsx)(yt.A,{size:18}),"Insights"]})]}),(0,L.jsxs)("main",{children:["overview"===l&&(0,L.jsxs)("section",{className:"overview-section",children:[(0,L.jsxs)("div",{className:"main-chart-container",children:[(0,L.jsxs)("div",{className:"chart-header",children:[(0,L.jsx)("h3",{children:"Andamento Mensile"}),(0,L.jsx)("div",{className:"metric-selector",children:(0,L.jsxs)("select",{className:"metric-select",value:c,onChange:e=>d(e.target.value),children:[(0,L.jsx)("option",{value:"Fatturato Rush",children:"Fatturato Rush"}),(0,L.jsx)("option",{value:"Fatturato Totale",children:"Fatturato Totale"}),(0,L.jsx)("option",{value:"Nuovi Clienti",children:"Nuovi Clienti"}),(0,L.jsx)("option",{value:"Agenti Attivi",children:"Agenti Attivi"})]})})]}),(0,L.jsx)("div",{className:"chart-wrapper",children:(0,L.jsx)(Z.u,{width:"100%",height:"100%",children:(0,L.jsxs)(Q.b,{data:u.monthlyData,margin:{top:5,right:30,left:50,bottom:5},children:[(0,L.jsx)($.d,{strokeDasharray:"3 3",stroke:"rgba(0,0,0,0.1)"}),(0,L.jsx)(X.W,{dataKey:"name",tick:{fill:"#64748b"}}),(0,L.jsx)(ee.h,{tickFormatter:e=>c.includes("Fatturato")?wt(e):kt(e),tick:{fill:"#64748b"}}),(0,L.jsx)(te.m,{content:(0,L.jsx)(Ot,{})}),(0,L.jsx)(ae.s,{}),(0,L.jsx)(se.N,{type:"monotone",dataKey:c,stroke:"#8b5cf6",strokeWidth:2,activeDot:{r:8}})]})})})]}),(0,L.jsx)("div",{className:"summary-cards",children:(0,L.jsxs)("div",{className:"summary-card",children:[(0,L.jsxs)("div",{className:"summary-header",children:[(0,L.jsx)("h4",{children:"Riepilogo Periodo"}),(0,L.jsx)(Y.A,{size:20})]}),(0,L.jsxs)("div",{className:"summary-content",children:[(0,L.jsxs)("div",{className:"metric-row",children:[(0,L.jsx)("span",{children:"Fatturato Totale"}),(0,L.jsx)("span",{className:"metric-value",children:wt(u.summary.totalRevenue)})]}),(0,L.jsxs)("div",{className:"metric-row",children:[(0,L.jsx)("span",{children:"Fatturato Rush"}),(0,L.jsx)("span",{className:"metric-value",children:wt(u.summary.totalRush)})]}),(0,L.jsxs)("div",{className:"metric-row",children:[(0,L.jsx)("span",{children:"Nuovi Clienti Totali"}),(0,L.jsx)("span",{className:"metric-value",children:kt(u.summary.totalNewClients)})]}),(0,L.jsxs)("div",{className:"metric-row",children:[(0,L.jsx)("span",{children:"Media Agenti Attivi"}),(0,L.jsx)("span",{className:"metric-value",children:kt(u.summary.averageAgents)})]})]})]})})]}),"trends"===l&&(0,L.jsx)("section",{className:"trends-section",children:(0,L.jsxs)("div",{className:"multi-chart-container",children:[(0,L.jsx)("div",{className:"chart-header",children:(0,L.jsx)("h3",{children:"Analisi dei Trend Mensili"})}),(0,L.jsxs)("div",{className:"trend-cards-grid",children:[(0,L.jsx)(Ft,{title:"Fatturato Totale",value:u.trends.revenue,icon:bt.A}),(0,L.jsx)(Ft,{title:"Fatturato Rush",value:u.trends.rush,icon:Y.A}),(0,L.jsx)(Ft,{title:"Nuovi Clienti",value:u.trends.clients,icon:Xe.A}),(0,L.jsx)(Ft,{title:"Agenti Attivi",value:u.trends.agents,icon:ge.A})]})]})}),"comparison"===l&&(0,L.jsxs)("section",{className:"comparison-section",children:[(0,L.jsx)("div",{className:"comparison-controls",children:(0,L.jsx)("h3",{children:"Confronto Periodi"})}),(0,L.jsx)("div",{className:"comparison-table",children:(0,L.jsxs)("table",{children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Metrica"}),u.comparisonData.headers.map(e=>(0,L.jsx)("th",{children:e},e))]})}),(0,L.jsx)("tbody",{children:u.comparisonData.rows.map(e=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"period-cell",children:e.metric}),e.values.map((e,t)=>(0,L.jsx)("td",{children:e},t))]},e.metric))})]})})]}),"insights"===l&&(0,L.jsxs)("section",{className:"insights-section",children:[(0,L.jsxs)("div",{className:"insights-header",children:[(0,L.jsx)("h3",{children:"Insights Automatici"}),(0,L.jsx)("p",{children:"Analisi e suggerimenti basati sui dati storici."})]}),(0,L.jsx)("div",{className:"insights-grid",children:u.insights.map((e,t)=>(0,L.jsx)(Rt,{insight:e},t))})]})]})]}):(0,L.jsx)("div",{className:"modern-historical-container",children:(0,L.jsx)(h,{setActiveSection:t})})};var zt=a(8188),Et=a(8147),Dt=a(1839);function Pt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function It(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(a),!0).forEach(function(t){Ut(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Pt(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function Ut(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Mt=e=>{let{user:t,mode:a,onClose:n,onSave:i}=e;const[r,l]=(0,s.useState)({username:(null==t?void 0:t.username)||"",full_name:(null==t?void 0:t.full_name)||"",role:(null==t?void 0:t.role)||"viewer",password:"",confirmPassword:""}),c=e=>{const{name:t,value:a}=e.target;l(e=>It(It({},e),{},{[t]:a}))},d={create:"Crea Nuovo Utente",password:"Modifica Password per ".concat(null==t?void 0:t.username),role:"Modifica Ruolo per ".concat(null==t?void 0:t.username)};return(0,L.jsx)("div",{className:"modal-overlay",children:(0,L.jsxs)("div",{className:"modal-content",children:[(0,L.jsx)("button",{className:"modal-close",onClick:n,children:(0,L.jsx)(re.A,{size:24})}),(0,L.jsx)("h2",{children:d[a]}),"create"===a&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"Username"}),(0,L.jsx)("input",{type:"text",name:"username",value:r.username,onChange:c})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"Nome Completo"}),(0,L.jsx)("input",{type:"text",name:"full_name",value:r.full_name,onChange:c})]})]}),("create"===a||"password"===a)&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"Nuova Password"}),(0,L.jsx)("input",{type:"password",name:"password",value:r.password,onChange:c})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"Conferma Nuova Password"}),(0,L.jsx)("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:c})]})]}),("create"===a||"role"===a)&&(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"Ruolo"}),(0,L.jsxs)("select",{name:"role",value:r.role,onChange:c,children:[(0,L.jsx)("option",{value:"viewer",children:"Viewer"}),(0,L.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,L.jsxs)("div",{className:"modal-actions",children:[(0,L.jsx)("button",{onClick:n,className:"btn btn-secondary",children:"Annulla"}),(0,L.jsx)("button",{onClick:()=>{"create"!==a&&"password"!==a||r.password===r.confirmPassword&&r.password?"create"===a?i(r):"role"===a?i(t.id,{role:r.role}):"password"===a&&i(t.id,{password:r.password}):o.Ay.error("Le password non coincidono o sono vuote.")},className:"btn btn-primary",children:"create"===a?"Crea Utente":"Salva"})]})]})})},_t=()=>{const[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(!0),[i,r]=(0,s.useState)(null),[l,c]=(0,s.useState)({isOpen:!1,mode:"create",user:null}),[d,u]=(0,s.useState)({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),m=(0,s.useCallback)(async()=>{try{n(!0);const e=await C.getUsers();t(e),r(null)}catch(e){r("Impossibile caricare gli utenti."),o.Ay.error("Impossibile caricare gli utenti."),console.error(e)}finally{n(!1)}},[]);(0,s.useEffect)(()=>{m()},[m]);const h=function(e){c({isOpen:!0,mode:e,user:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null})},p=()=>{c({isOpen:!1,mode:"create",user:null})},x=()=>{u(It(It({},d),{},{isOpen:!1}))};return(0,L.jsxs)("div",{className:"modern-settings-container",children:[(0,L.jsx)("div",{className:"page-header",children:(0,L.jsxs)("div",{className:"header-content",children:[(0,L.jsxs)("div",{className:"header-text",children:[(0,L.jsxs)("h1",{className:"page-title",children:[(0,L.jsx)(me.A,{size:32})," Gestione Utenti"]}),(0,L.jsx)("p",{className:"page-subtitle",children:"Modifica ruoli e password degli utenti del sistema"})]}),(0,L.jsxs)("div",{className:"header-actions",children:[(0,L.jsxs)("button",{className:"refresh-btn ".concat(a?"refreshing":""),onClick:m,disabled:a,children:[(0,L.jsx)(fe.A,{size:20}),a?"Aggiorna...":"Aggiorna"]}),(0,L.jsxs)("button",{className:"btn btn-primary",onClick:()=>h("create"),children:[(0,L.jsx)(Xe.A,{size:18})," Crea Utente"]})]})]})}),(0,L.jsx)("div",{className:"settings-content",children:(0,L.jsxs)("div",{className:"user-list-container",children:[a&&(0,L.jsx)("p",{children:"Caricamento utenti..."}),i&&(0,L.jsx)("p",{className:"error-message",children:i}),!a&&!i&&(0,L.jsxs)("table",{className:"user-table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Username"}),(0,L.jsx)("th",{children:"Nome Completo"}),(0,L.jsx)("th",{children:"Ruolo"}),(0,L.jsx)("th",{children:"Data Creazione"}),(0,L.jsx)("th",{children:"Azioni"})]})}),(0,L.jsx)("tbody",{children:e.map(e=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:e.username}),(0,L.jsx)("td",{children:e.full_name}),(0,L.jsx)("td",{children:(0,L.jsx)("span",{className:"role-badge ".concat(e.role),children:e.role})}),(0,L.jsx)("td",{children:new Date(e.created_at).toLocaleDateString()}),(0,L.jsxs)("td",{className:"actions-cell",children:[(0,L.jsx)("button",{className:"action-btn",title:"Modifica Ruolo",onClick:()=>h("role",e),children:(0,L.jsx)(zt.A,{size:18})}),(0,L.jsx)("button",{className:"action-btn",title:"Modifica Password",onClick:()=>h("password",e),children:(0,L.jsx)(Et.A,{size:18})}),(0,L.jsx)("button",{className:"action-btn delete",title:"Elimina Utente",onClick:()=>(e=>{var t,a;t="Sei sicuro di voler eliminare l'utente ".concat(e.username,"? Questa azione Ã¨ irreversibile."),a=async()=>{o.Ay.loading("Eliminazione di ".concat(e.username,"..."),{id:"delete-user"});try{await C.deleteUser(e.id),o.Ay.success("Utente ".concat(e.username," eliminato."),{id:"delete-user"}),m()}catch(e){o.Ay.error("Errore: ".concat(e.message),{id:"delete-user"})}},u({isOpen:!0,title:"Conferma Eliminazione",message:t,onConfirm:()=>{a(),x()}})})(e),children:(0,L.jsx)(Dt.A,{size:18})})]})]},e.id))})]})]})}),l.isOpen&&(0,L.jsx)(Mt,{user:l.user,mode:l.mode,onClose:p,onSave:"create"===l.mode?async e=>{o.Ay.loading("Creazione utente...",{id:"create-user"});try{await C.createUser(e),o.Ay.success("Utente creato con successo!",{id:"create-user"}),m(),p()}catch(e){o.Ay.error("Errore: ".concat(e.message),{id:"create-user"})}}:"role"===l.mode?async(e,t)=>{let{role:a}=t;o.Ay.loading("Aggiornamento ruolo...",{id:"role-update"});try{await C.updateUserRole(e,a),o.Ay.success("Ruolo aggiornato con successo!",{id:"role-update"}),m(),p()}catch(e){o.Ay.error("Errore: ".concat(e.message),{id:"role-update"})}}:async(e,t)=>{let{password:a}=t;o.Ay.loading("Aggiornamento password...",{id:"password-update"});try{await C.adminUpdateUserPassword(e,a),o.Ay.success("Password aggiornata con successo!",{id:"password-update"}),p()}catch(e){o.Ay.error("Errore: ".concat(e.message),{id:"password-update"})}}}),(0,L.jsx)(q,{open:d.isOpen,onClose:x,onConfirm:d.onConfirm,title:d.title,message:d.message})]})},Lt=()=>{const{data:e,selectedFileDate:t}=na(),{agents:a,agentKeys:n}=(0,s.useMemo)(()=>{if(!t||!e.processedData[t])return{agents:[],agentKeys:[]};const a=e.processedData[t].agents.slice(0,10);if(0===a.length)return{agents:[],agentKeys:[]};const s=new Set;return a.forEach(e=>{Object.keys(e).forEach(e=>s.add(e))}),{agents:a,agentKeys:Array.from(s).sort()}},[e,t]);return 0===a.length?(0,L.jsxs)("div",{className:"test-page-container",children:[(0,L.jsx)("h2",{children:"Test Page - Dati Agenti"}),(0,L.jsx)("p",{children:"Nessun dato disponibile per il file selezionato o nessun file caricato."}),(0,L.jsx)("p",{children:'Vai su "Gestione File" per caricare un file.'})]}):(0,L.jsxs)("div",{className:"test-page-container",children:[(0,L.jsx)("h2",{children:"Test Page - Primi 10 Agenti"}),(0,L.jsx)("p",{children:"Questa tabella mostra i dati grezzi dei primi 10 agenti importati dal file per il debug della mappatura."}),(0,L.jsx)("div",{className:"table-container",children:(0,L.jsxs)("table",{children:[(0,L.jsx)("thead",{children:(0,L.jsx)("tr",{children:n.map(e=>(0,L.jsx)("th",{children:e},e))})}),(0,L.jsx)("tbody",{children:a.map((e,t)=>(0,L.jsx)("tr",{children:n.map(t=>(0,L.jsx)("td",{children:"object"==typeof e[t]?JSON.stringify(e[t]):e[t]},t))},t))})]})})]})},qt=e=>new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(e||0),Bt=e=>new Intl.NumberFormat("it-IT").format(e||0),Vt=()=>{var e;const{data:t,selectedFileDate:a,setSelectedFileDate:n}=na(),i=(0,s.useMemo)(()=>{var e;if(!t.uploadedFiles||0===t.uploadedFiles.length)return{totalAgents:0,totalSMs:0,totalRevenue:0,totalRush:0,totalNewClients:0,totalFastweb:0,avgRush:0,topAgent:null,topSM:null,recentFiles:[]};const s=a?t.uploadedFiles.find(e=>e.date===a):t.uploadedFiles[0];if(null==s||null===(e=s.data)||void 0===e||!e.agents)return{totalAgents:0,totalSMs:0,totalRevenue:0,totalRush:0,totalNewClients:0,totalFastweb:0,avgRush:0,topAgent:null,topSM:null,recentFiles:t.uploadedFiles.slice(-3).reverse()};const n=s.data.agents,i=n.reduce((e,t)=>{var a;return e+((null===(a=t.fatturato)||void 0===a?void 0:a.complessivo)||0)},0),r=n.reduce((e,t)=>e+(t.fatturatoRush||0),0),l=n.reduce((e,t)=>e+(t.nuovoCliente||0),0),o=n.reduce((e,t)=>e+(t.fastwebEnergia||0),0),c=n.reduce((e,t)=>(t.fatturatoRush||0)>((null==e?void 0:e.fatturatoRush)||0)?t:e,null);return{totalAgents:n.length,totalSMs:[...new Set(n.map(e=>e.sm).filter(Boolean))].length,totalRevenue:i,totalRush:r,totalNewClients:l,totalFastweb:o,avgRush:n.length>0?r/n.length:0,topAgent:c,recentFiles:t.uploadedFiles.slice(-3).reverse(),currentPeriod:s.displayDate}},[t,a]);return(0,L.jsxs)("div",{className:"integrated-dashboard",children:[(0,L.jsxs)("div",{className:"dashboard-hero",children:[(0,L.jsx)("div",{className:"hero-content",children:(0,L.jsxs)("div",{className:"welcome-section",children:[(0,L.jsxs)("h1",{className:"hero-title",children:[(0,L.jsx)(le.A,{size:40}),"Dashboard RUSH"]}),(0,L.jsx)("p",{className:"hero-subtitle",children:"Panoramica performance commerciali"})]})}),(0,L.jsxs)("div",{className:"performance-overview",children:[(0,L.jsxs)("div",{className:"perf-card agents",children:[(0,L.jsx)("div",{className:"perf-icon",children:(0,L.jsx)(ge.A,{size:32})}),(0,L.jsxs)("div",{className:"perf-content",children:[(0,L.jsx)("span",{className:"perf-value",children:Bt(i.totalAgents)}),(0,L.jsx)("span",{className:"perf-label",children:"Agenti Attivi"}),(0,L.jsxs)("div",{className:"perf-meta",children:[i.totalSMs," Sales Manager"]})]})]}),(0,L.jsxs)("div",{className:"perf-card revenue",children:[(0,L.jsx)("div",{className:"perf-icon",children:(0,L.jsx)(G.A,{size:32})}),(0,L.jsxs)("div",{className:"perf-content",children:[(0,L.jsx)("span",{className:"perf-value",children:qt(i.totalRevenue)}),(0,L.jsx)("span",{className:"perf-label",children:"Fatturato Totale"})]})]}),(0,L.jsxs)("div",{className:"perf-card rush",children:[(0,L.jsx)("div",{className:"perf-icon",children:(0,L.jsx)(Y.A,{size:32})}),(0,L.jsxs)("div",{className:"perf-content",children:[(0,L.jsx)("span",{className:"perf-value",children:qt(i.totalRush)}),(0,L.jsx)("span",{className:"perf-label",children:"Rush Totale"})]})]}),(0,L.jsxs)("div",{className:"perf-card clients",children:[(0,L.jsx)("div",{className:"perf-icon",children:(0,L.jsx)(Te.A,{size:32})}),(0,L.jsxs)("div",{className:"perf-content",children:[(0,L.jsx)("span",{className:"perf-value",children:Bt(i.totalNewClients)}),(0,L.jsx)("span",{className:"perf-label",children:"Nuovi Clienti"})]})]})]})]}),(0,L.jsxs)("div",{className:"dashboard-grid",children:[(0,L.jsxs)("div",{className:"dashboard-card performers",children:[(0,L.jsxs)("div",{className:"card-header",children:[(0,L.jsxs)("h3",{children:[(0,L.jsx)(Re.A,{size:20}),"Top Performers"]}),(0,L.jsx)("span",{className:"card-badge",children:"Live"})]}),(0,L.jsx)("div",{className:"performers-content",children:i.topAgent?(0,L.jsxs)("div",{className:"top-performer",children:[(0,L.jsx)("div",{className:"performer-rank",children:(0,L.jsx)(Re.A,{size:24,className:"text-yellow-500"})}),(0,L.jsxs)("div",{className:"performer-info",children:[(0,L.jsx)("h4",{children:B(i.topAgent.nome)}),(0,L.jsx)("p",{children:B(i.topAgent.sm)}),(0,L.jsxs)("div",{className:"performer-stats",children:[(0,L.jsxs)("span",{children:[(0,L.jsx)(Y.A,{size:14}),qt(i.topAgent.fatturatoRush||0)]}),(0,L.jsxs)("span",{children:[(0,L.jsx)(G.A,{size:14}),qt((null===(e=i.topAgent.fatturato)||void 0===e?void 0:e.complessivo)||0)]})]})]})]}):(0,L.jsxs)("div",{className:"no-data-small",children:[(0,L.jsx)(Re.A,{size:32,className:"opacity-30"}),(0,L.jsx)("p",{children:"Carica i dati per visualizzare i top performer"})]})})]}),(0,L.jsxs)("div",{className:"dashboard-card metrics",children:[(0,L.jsx)("div",{className:"card-header",children:(0,L.jsxs)("h3",{children:[(0,L.jsx)(Ke.A,{size:20}),"Metriche Chiave"]})}),(0,L.jsxs)("div",{className:"metrics-grid",children:[(0,L.jsxs)("div",{className:"metric-item",children:[(0,L.jsx)("div",{className:"metric-icon avg",children:(0,L.jsx)(Te.A,{size:20})}),(0,L.jsxs)("div",{className:"metric-content",children:[(0,L.jsx)("span",{className:"metric-value",children:qt(i.avgRush)}),(0,L.jsx)("span",{className:"metric-label",children:"Rush Medio"})]})]}),(0,L.jsxs)("div",{className:"metric-item",children:[(0,L.jsx)("div",{className:"metric-icon fastweb",children:(0,L.jsx)(he.A,{size:20})}),(0,L.jsxs)("div",{className:"metric-content",children:[(0,L.jsx)("span",{className:"metric-value",children:Bt(i.totalFastweb)}),(0,L.jsx)("span",{className:"metric-label",children:"Fastweb Energia"})]})]})]})]})]})]})};var Gt=a(4796),Yt=a(964),Kt=a(4539),Wt=a(8676),Ht=a(5042);const Jt=e=>{let{activeSection:t,setActiveSection:a,currentUser:s,onLogout:n,isMobile:i,isCollapsed:r,setIsCollapsed:l,isDarkMode:o,setIsDarkMode:c}=e;const d=[{id:"dashboard",label:"Dashboard",icon:le.A,color:"from-blue-500 to-blue-600",description:"Panoramica generale"},{id:"sm-ranking",label:"Classifica SM",icon:Oe.A,color:"from-yellow-500 to-yellow-600",description:"Ranking coordinatori"},{id:"agents",label:"Agenti",icon:ge.A,color:"from-green-500 to-green-600",description:"Gestione agenti"},{id:"products",label:"Prodotti",icon:W.A,color:"from-purple-500 to-purple-600",description:"Analisi prodotti"},{id:"new-clients",label:"Nuovi Clienti",icon:Xe.A,color:"from-pink-500 to-pink-600",description:"Dashboard clienti"},{id:"fastweb",label:"Fastweb",icon:he.A,color:"from-orange-500 to-orange-600",description:"Contratti Fastweb"},{id:"historical-analysis",label:"Analisi Storica",icon:At.A,color:"from-purple-500 to-purple-600",description:"Analisi storica dei dati"}],u=[{id:"files",label:"Gestione File",icon:Gt.A,color:"from-indigo-500 to-indigo-600",description:"Upload e gestione"},{id:"settings",label:"Gestione Utenti",icon:Yt.A,color:"from-purple-500 to-purple-600",description:"Gestisci gli utenti"}],m=e=>{a(e),i&&l(!0)};return(0,L.jsxs)(L.Fragment,{children:[i&&!r&&(0,L.jsx)("div",{className:"sidebar-overlay",onClick:()=>l(!0)}),(0,L.jsxs)("div",{className:"modern-sidebar ".concat(r&&i?"collapsed":""," ").concat(o?"dark":""),children:[(0,L.jsxs)("div",{className:"sidebar-header",children:[(0,L.jsxs)("div",{className:"brand",children:[(0,L.jsx)("div",{className:"brand-icon",children:(0,L.jsx)(Y.A,{size:32})}),(!r||!i)&&(0,L.jsxs)("div",{className:"brand-text",children:[(0,L.jsx)("h1",{children:"RUSH"}),(0,L.jsx)("span",{children:"Dashboard"})]})]}),i&&(0,L.jsx)("button",{className:"close-sidebar",onClick:()=>l(!0),children:(0,L.jsx)(re.A,{size:24})})]}),(0,L.jsxs)("nav",{className:"sidebar-nav",children:[(0,L.jsxs)("div",{className:"nav-section",children:[(0,L.jsx)("span",{className:"section-title",children:"Principale"}),d.slice(0,4).map(e=>{const a=e.icon,s=t===e.id;return(0,L.jsxs)("button",{className:"nav-item ".concat(s?"active":""),onClick:()=>m(e.id),children:[(0,L.jsx)("div",{className:"nav-icon bg-gradient-to-r ".concat(e.color),children:(0,L.jsx)(a,{size:20})}),(!r||!i)&&(0,L.jsxs)("div",{className:"nav-content",children:[(0,L.jsx)("span",{className:"nav-label",children:e.label}),(0,L.jsx)("span",{className:"nav-description",children:e.description})]}),s&&(0,L.jsx)("div",{className:"active-indicator"})]},e.id)})]}),(0,L.jsxs)("div",{className:"nav-section",children:[(0,L.jsx)("span",{className:"section-title",children:"Analisi"}),d.slice(4).map(e=>{const a=e.icon,s=t===e.id;return(0,L.jsxs)("button",{className:"nav-item ".concat(s?"active":""),onClick:()=>m(e.id),children:[(0,L.jsx)("div",{className:"nav-icon bg-gradient-to-r ".concat(e.color),children:(0,L.jsx)(a,{size:20})}),(!r||!i)&&(0,L.jsxs)("div",{className:"nav-content",children:[(0,L.jsx)("span",{className:"nav-label",children:e.label}),(0,L.jsx)("span",{className:"nav-description",children:e.description})]}),s&&(0,L.jsx)("div",{className:"active-indicator"})]},e.id)})]}),("admin"===(null==s?void 0:s.role)||"viewer"===(null==s?void 0:s.role))&&(0,L.jsxs)("div",{className:"nav-section",children:[(0,L.jsx)("span",{className:"section-title",children:"Impostazioni"}),u.filter(e=>"files"===e.id||"settings"===e.id&&"admin"===s.role).map(e=>{const a=e.icon,s=t===e.id;return(0,L.jsxs)("button",{className:"nav-item ".concat(s?"active":""),onClick:()=>m(e.id),children:[(0,L.jsx)("div",{className:"nav-icon bg-gradient-to-r ".concat(e.color),children:(0,L.jsx)(a,{size:20})}),(!r||!i)&&(0,L.jsxs)("div",{className:"nav-content",children:[(0,L.jsx)("span",{className:"nav-label",children:e.label}),(0,L.jsx)("span",{className:"nav-description",children:e.description})]}),s&&(0,L.jsx)("div",{className:"active-indicator"})]},e.id)})]})]}),(0,L.jsxs)("div",{className:"sidebar-footer",children:[(0,L.jsxs)("div",{className:"user-section",children:[(0,L.jsx)("div",{className:"user-avatar",children:(0,L.jsx)(V.A,{size:24})}),(!r||!i)&&(0,L.jsxs)("div",{className:"user-info",children:[(0,L.jsx)("span",{className:"user-name",children:(null==s?void 0:s.username)||"Admin"}),(0,L.jsx)("span",{className:"user-role",children:(null==s?void 0:s.role)||"Administrator"})]})]}),(0,L.jsxs)("div",{className:"footer-actions",children:[(0,L.jsx)("button",{className:"action-btn",onClick:()=>c(!o),children:o?(0,L.jsx)(Kt.A,{size:20}):(0,L.jsx)(Wt.A,{size:20})}),(0,L.jsx)("button",{className:"action-btn logout",onClick:n,children:(0,L.jsx)(Ht.A,{size:20})})]})]})]})]})};var Zt=a(9230),Qt=a(1805),$t=a(7677);const Xt=e=>{var t;let{activeSection:a,isMobile:s,isCollapsed:n,setIsCollapsed:i,currentUser:r,isDarkMode:l}=e;const{data:o,selectedFileDate:c,setSelectedFileDate:d}=na();return(0,L.jsxs)("header",{className:"modern-topbar ".concat(l?"dark":""),children:[(0,L.jsxs)("div",{className:"topbar-left",children:[s&&(0,L.jsx)("button",{className:"menu-toggle",onClick:()=>i(!n),children:(0,L.jsx)(Zt.A,{size:24})}),(0,L.jsxs)("div",{className:"breadcrumb",children:[(0,L.jsx)(Qt.A,{size:16}),(0,L.jsx)($t.A,{size:16}),(0,L.jsx)("span",{children:{dashboard:"Dashboard","sm-ranking":"Classifica Sales Manager",agents:"Gestione Agenti",products:"Analisi Prodotti","new-clients":"Nuovi Clienti",fastweb:"Fastweb Energia",files:"Gestione File"}[a]||"Dashboard"})]})]}),(0,L.jsxs)("div",{className:"topbar-right",children:[(0,L.jsxs)("div",{className:"quick-stats",children:[o.uploadedFiles&&o.uploadedFiles.length>0&&(0,L.jsx)("div",{className:"period-selector",children:(0,L.jsx)("select",{id:"period-select-topbar",value:c||(null===(t=o.uploadedFiles[0])||void 0===t?void 0:t.date)||"",onChange:e=>d(e.target.value),children:o.uploadedFiles.map(e=>(0,L.jsx)("option",{value:e.date,children:e.displayDate},e.id))})}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)(ie.A,{size:16}),(0,L.jsx)("span",{children:(new Date).toLocaleDateString("it-IT")})]})]}),(0,L.jsxs)("div",{className:"user-menu",children:[(0,L.jsx)("div",{className:"user-avatar-small",children:(0,L.jsx)(V.A,{size:18})}),(0,L.jsxs)("div",{className:"user-details",children:[(0,L.jsx)("span",{className:"user-name-small",children:(null==r?void 0:r.username)||"Admin"}),(0,L.jsx)("span",{className:"user-status",children:"Online"})]})]})]})]})};function ea(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function ta(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ea(Object(a),!0).forEach(function(t){aa(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ea(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function aa(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const sa=(0,s.createContext)(),na=()=>{const e=(0,s.useContext)(sa);if(!e)throw new Error("useData must be used within a DataProvider");return e},ia=e=>{let{children:t,isAuthenticated:a}=e;const[n,i]=(0,s.useState)({uploadedFiles:[],processedData:{},selectedSM:null,selectedAgent:null}),[r,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(!1),u=(0,s.useCallback)(async()=>{if(a)try{d(!0),console.log("ðŸ”„ Caricamento globale dati dal database...");const t=await C.loadFiles();if(!t||!Array.isArray(t)||0===t.length)return console.log("ðŸ“ Nessun file trovato nel database"),void i(e=>ta(ta({},e),{},{uploadedFiles:[],processedData:{}}));console.log("ðŸ“ ".concat(t.length," file trovati nel database"));const a=function(e){return[...e].sort((e,t)=>{try{const a=e.date||T(e.name).dateString,s=t.date||T(t.name).dateString;return new Date(s)-new Date(a)}catch(a){return console.warn("Errore nell'ordinamento dei file:",a),t.name.localeCompare(e.name)}})}(await Promise.all(t.map(async e=>{try{var t,a,s,n,i,r;let l=null;if(e.file_data)l="string"==typeof e.file_data?JSON.parse(e.file_data):e.file_data;else try{l=await C.getFileData(e.file_date)}catch(t){console.warn("Impossibile caricare dati dettagliati per ".concat(e.file_date))}return{id:e.id,name:e.file_name,date:e.file_date,displayDate:e.display_date,uploadDate:e.upload_date,size:e.file_size,data:l,metadata:l?{totalAgents:(null===(t=l.metadata)||void 0===t?void 0:t.totalAgents)||0,totalSMs:(null===(a=l.metadata)||void 0===a?void 0:a.totalSMs)||0,totalRevenue:(null===(s=l.metadata)||void 0===s?void 0:s.totalRevenue)||0,totalRush:(null===(n=l.metadata)||void 0===n?void 0:n.totalRush)||0,totalNewClients:(null===(i=l.metadata)||void 0===i?void 0:i.totalNewClients)||0,totalFastweb:(null===(r=l.metadata)||void 0===r?void 0:r.totalFastweb)||0}:{totalAgents:e.total_agents||0,totalSMs:e.total_sms||0,totalRevenue:e.total_revenue||0,totalRush:e.total_rush||0,totalNewClients:e.total_new_clients||0,totalFastweb:e.total_fastweb||0}}}catch(t){return console.warn("Errore processamento file ".concat(e.file_date,":"),t),{id:e.id,name:e.file_name,date:e.file_date,displayDate:e.display_date,uploadDate:e.upload_date,size:e.file_size,data:null,metadata:{totalAgents:0,totalSMs:0,totalRevenue:0,totalRush:0,totalNewClients:0,totalFastweb:0}}}}))),s={};a.forEach(e=>{e.data&&(s[e.date]=e.data)});const n=r&&a.find(e=>e.date===r)?r:a.length>0?a[0].date:null;var e;i(e=>ta(ta({},e),{},{uploadedFiles:a,processedData:s})),l(n),console.log("âœ… ".concat(a.length," file caricati con successo globalmente")),a.length>0&&n&&console.log("ðŸ“‹ File selezionato: ".concat((null===(e=a.find(e=>e.date===n))||void 0===e?void 0:e.displayDate)||"N/A"))}catch(e){console.error("Errore nel caricamento globale dei file:",e),o.Ay.error("Errore nel caricamento dei dati dal database"),i(e=>ta(ta({},e),{},{uploadedFiles:[],processedData:{}}))}finally{d(!1)}},[a,r]);(0,s.useEffect)(()=>{a?(console.log("ðŸ” Utente autenticato - Avvio caricamento dati..."),u()):(i({uploadedFiles:[],processedData:{},selectedSM:null,selectedAgent:null}),l(null),d(!1))},[a,u]);const m={data:n,setData:i,selectedFileDate:r,setSelectedFileDate:l,loadFiles:u,globalLoading:c};return(0,L.jsx)(sa.Provider,{value:m,children:t})},ra=(0,i.A)({palette:{mode:"light",primary:{main:"#1976d2"},secondary:{main:"#dc004e"},background:{default:"#f5f5f5"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',h4:{fontWeight:600}}}),la=e=>{let{onLogin:t}=e;const[a,n]=(0,s.useState)({username:"",password:""}),[i,r]=(0,s.useState)(!1);return(0,L.jsx)("div",{className:"modern-login-container",children:(0,L.jsxs)("div",{className:"modern-login-card",children:[(0,L.jsxs)("div",{className:"modern-login-header",children:[(0,L.jsx)("h1",{children:"ðŸ† RUSH"}),(0,L.jsx)("p",{children:"Gara di Produzione Agenti"})]}),(0,L.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const e=await C.login(a.username,a.password);e.success?(t(e.user),o.Ay.success("Benvenuto, ".concat(e.user.full_name||e.user.username,"!"))):o.Ay.error(e.error||"Credenziali non valide")}catch(e){o.Ay.error("Errore di connessione"),console.error("Login error:",e)}finally{r(!1)}},className:"modern-login-form",children:[(0,L.jsxs)("div",{className:"modern-form-group",children:[(0,L.jsx)("label",{htmlFor:"username",children:"Username"}),(0,L.jsx)("input",{id:"username",type:"text",value:a.username,onChange:e=>n(ta(ta({},a),{},{username:e.target.value})),placeholder:"es. mario.rossi",required:!0})]}),(0,L.jsxs)("div",{className:"modern-form-group",children:[(0,L.jsx)("label",{htmlFor:"password",children:"Password"}),(0,L.jsx)("input",{id:"password",type:"password",value:a.password,onChange:e=>n(ta(ta({},a),{},{password:e.target.value})),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0})]}),(0,L.jsx)("button",{type:"submit",className:"modern-login-btn ".concat(i?"loading":""),disabled:i,children:i?"Accesso...":"Accedi"})]})]})})},oa=e=>{let{openDialog:t,currentUser:a}=e;const{data:n,loadFiles:i,globalLoading:r}=na(),[l,c]=(0,s.useState)(!1),d="viewer"===(null==a?void 0:a.role);return r?(0,L.jsx)("div",{className:"file-upload-section",children:(0,L.jsxs)("div",{className:"loading-indicator",children:[(0,L.jsx)("div",{className:"loading-spinner"}),"Caricamento file dal database..."]})}):(0,L.jsxs)("div",{className:"file-upload-section",children:[d?(0,L.jsxs)("div",{className:"viewer-message",children:[(0,L.jsx)("p",{children:"La funzione di caricamento ed eliminazione Ã¨ disponibile solo per gli amministratori."}),(0,L.jsx)("p",{children:"Contatta un amministratore per gestire i file."})]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("h3",{children:"ðŸ“ Carica File Mensile"}),(0,L.jsxs)("div",{className:"upload-area",children:[(0,L.jsx)("input",{type:"file",id:"file-upload",accept:".xlsx,.xls",onChange:async e=>{const a=e.target.files[0];if(a){c(!0),o.Ay.loading("Parsing del file Excel...",{id:"upload"});try{var s;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(a.type)&&!a.name.toLowerCase().endsWith(".xlsx"))return void o.Ay.error("File non valido. Sono supportati solo file Excel (.xlsx, .xls)",{id:"upload"});const e=await async function(e){try{console.log("ðŸ”„ Inizio parsing dinamico:",e.name);const t=T(e.name);console.log("ðŸ“… Data estratta:",t);const a=await e.arrayBuffer(),s=S.LF(a,{type:"array"});if(!s.SheetNames.length)throw new Error("Il file Excel non contiene fogli di lavoro");const n=s.Sheets[s.SheetNames[0]];console.log("ðŸ“Š Foglio selezionato:",s.SheetNames[0]);const i=function(e){const t=S.Wp.decode_range(e["!ref"]||"A1:A1"),a=["agente","nome","fatturato","rush","sm","coordinatore","inflow"];let s=-1,n=0;for(let i=0;i<=Math.min(15,t.e.r);i++){let r=0,l=0;for(let s=0;s<=Math.min(50,t.e.c);s++){const t=e[S.Wp.encode_cell({r:i,c:s})];if(t&&void 0!==t.v&&""!==t.v){l++;const e=t.v.toString().toLowerCase();for(const t of a)e.includes(t)&&(r+=10);e.length>2&&e.length<35&&(r+=1)}}if(l>5){const e=r+l;e>n&&(n=e,s=i)}}if(-1===s)throw new Error("Impossibile trovare una riga di header valida nel file.");return console.log("âœ… Riga header selezionata dinamicamente: ".concat(s+1," (punteggio: ").concat(n,")")),s}(n),{mapping:r,missingColumns:l,warnings:o,availableColumns:c,totalColumns:d}=function(e,t){const a=S.Wp.decode_range(e["!ref"]||"A1:A1"),s={},n=[],i=[],r=[],l=[];for(let s=0;s<=a.e.c;s++){const a=e[S.Wp.encode_cell({r:t,c:s})];if(a&&void 0!==a.v&&""!==a.v){const e=S.Wp.encode_col(s),t=a.v.toString().trim();l.push({col:e,name:t,normalized:t.toLowerCase()}),n.push("".concat(e,": ").concat(t))}}console.log("ðŸ“‹ Trovati ".concat(l.length," header nel file"));const o=new Set;for(const[e,t]of Object.entries(R))for(const a of l)if(!o.has(a.col)){for(const n of t.patterns)if(a.normalized===n.toLowerCase()){s[e]=a.col,o.add(a.col),console.log("âœ… [EXACT] ".concat(e," â†’ ").concat(a.col,' ("').concat(a.name,'")'));break}if(s[e])break}for(const[e,t]of Object.entries(R)){if(s[e])continue;let a=null,n=0;for(const s of l)if(!o.has(s.col))for(const i of t.patterns){let t=0;const r=i.toLowerCase();"FATTURATO_RUSH"===e&&s.normalized.includes("complessivo")||(s.normalized.includes(r)?t=80+r.length:r.includes(s.normalized)&&(t=60+s.normalized.length),t>n&&(n=t,a=s))}a?(s[e]=a.col,o.add(a.col),console.log("âœ… [PARTIAL] ".concat(e," â†’ ").concat(a.col,' ("').concat(a.name,'") [score: ').concat(n,"]"))):t.required?(i.push({field:e,patterns:t.patterns,required:!0,description:t.description}),console.warn("âŒ OBBLIGATORIO MANCANTE: ".concat(e))):(r.push({field:e,patterns:t.patterns,required:!1,description:t.description}),console.log("âš ï¸ Opzionale mancante: ".concat(e," (sarÃ  0)")))}return{mapping:s,missingColumns:i,warnings:r,availableColumns:n,totalColumns:l.length}}(n,i);if(console.log("ðŸŽ¯ Mappatura creata:",Object.keys(r).length,"campi mappati"),console.log("âš ï¸ Campi mancanti obbligatori:",l.length),console.log("ðŸ’¡ Campi opzionali mancanti:",o.length),l.length>0){const e=l.map(e=>e.field).join(", ");return console.error("âŒ CAMPI OBBLIGATORI MANCANTI:",e),{success:!1,needsMapping:!0,error:"Campi obbligatori mancanti: ".concat(e),missingColumns:l,availableColumns:c,totalColumns:d}}const u=S.Wp.decode_range(n["!ref"]||"A1:A1"),m=[],h=new Map;console.log("ðŸ Parsing righe da",i+1,"a",u.e.r);for(let e=i+1;e<=u.e.r;e++)try{const t=r.AGENTE;if(!t)continue;const a=n[S.Wp.encode_cell({r:e,c:F(t)})];if(!a||!a.v||""===a.v.toString().trim())continue;const s=O(n,e,r);if(!s.nome||""===s.nome.trim())continue;if(!s.sm||""===s.sm.trim())continue;m.push(s),h.has(s.sm)||h.set(s.sm,{nome:s.sm,agenti:[],fatturatoTotale:0,fatturatoRush:0,nuovoCliente:0,totaleFastweb:0});const i=h.get(s.sm);i.agenti.push(s),i.fatturatoTotale+=s.fatturato.complessivo,i.fatturatoRush+=s.fatturatoRush,i.nuovoCliente+=s.nuovoCliente,i.totaleFastweb+=s.totaleFastweb}catch(t){console.warn("Errore riga ".concat(e+1,":"),t);continue}console.log("âœ… Parsing completato: ".concat(m.length," agenti trovati"));const p=m.reduce((e,t)=>(e.totalRevenue+=t.fatturato.complessivo,e.totalRush+=t.fatturatoRush,e.totalNewClients+=t.nuovoCliente,e.totalFastweb+=t.totaleFastweb,e),{totalRevenue:0,totalRush:0,totalNewClients:0,totalFastweb:0});console.log("ðŸ’° Totali calcolati:",{fatturato:z(p.totalRevenue),fatturatoRush:z(p.totalRush),nuovoCliente:p.totalNewClients,fastweb:p.totalFastweb});const x={success:!0,data:{agents:m,smData:Array.from(h.values()),fileInfo:{name:e.name,dateInfo:t,parsedRows:m.length,headerRow:i+1,totalColumns:d},metadata:{totalAgents:m.length,totalSMs:h.size,totalRevenue:p.totalRevenue,totalRush:p.totalRush,totalNewClients:p.totalNewClients,totalFastweb:p.totalFastweb,dateInfo:t,warnings:o.length>0?o:null}}};return console.log("ðŸŽ‰ Parsing completato con successo!"),x}catch(e){return console.error("âŒ Errore parsing:",e),{success:!1,error:e.message}}}(a);if(!e.success){if(!e.needsMapping)return void o.Ay.error("âŒ Errore nel parsing del file: ".concat(e.error),{id:"upload"});if(!window.confirm("âš ï¸ ATTENZIONE: Alcune colonne non sono state trovate automaticamente.\n\n"+"Colonne mancanti: ".concat(e.missingColumns.map(e=>e.field).join(", "),"\n\n")+"Colonne disponibili nel file: ".concat(e.availableColumns.slice(0,10).join(", ")).concat(e.availableColumns.length>10?"...":"","\n\n")+"Vuoi procedere comunque? I campi mancanti saranno impostati a 0."))return void o.Ay.error("Caricamento annullato",{id:"upload"})}if(null!==(s=e.data)&&void 0!==s&&null!==(s=s.metadata)&&void 0!==s&&s.warnings&&e.data.metadata.warnings.length>0){const t=e.data.metadata.warnings.length,a=e.data.metadata.warnings.map(e=>e.field).join(", ");o.Ay.success("âš¡ File parsato con successo!\n"+"âš ï¸ ".concat(t," campi opzionali impostati a zero: ").concat(a,"\n")+"Questo Ã¨ normale per prodotti non disponibili in certi periodi.",{id:"upload",duration:6e3})}const{data:r}=e,l=r.metadata.dateInfo.dateString,c=async()=>{const e={name:a.name,date:l,displayDate:"".concat(r.metadata.dateInfo.month,"/").concat(r.metadata.dateInfo.year),size:a.size,data:r,metadata:{totalAgents:r.metadata.totalAgents,totalSMs:r.metadata.totalSMs,totalRevenue:r.metadata.totalRevenue,totalRush:r.metadata.totalRush,totalNewClients:r.metadata.totalNewClients,totalFastweb:r.metadata.totalFastweb||0,parseDate:(new Date).toISOString(),warnings:r.metadata.warnings}},t=await C.saveFile(e);if(!t.success)throw new Error(t.error||"Errore sconosciuto durante il caricamento");{const e=r.metadata.totalAgents,a=r.metadata.totalSMs,s=r.metadata.totalRevenue,n=r.metadata.totalRush,l="updated"===t.action?"aggiornato":"caricato";o.Ay.success("âœ… File ".concat(l," con successo!\n")+"ðŸ‘¥ ".concat(e," agenti importati\n")+"ðŸ‘” ".concat(a," coordinatori\n")+"ðŸ’° ".concat(z(s)," fatturato\n")+"âš¡ ".concat(z(n)," Fatturato Rush"),{id:"upload",duration:5e3}),await i()}},d=n.uploadedFiles.find(e=>e.date===l);if(d){o.Ay.dismiss("upload");const e="".concat(r.metadata.dateInfo.month,"/").concat(r.metadata.dateInfo.year);t("Sovrascrivi file","âš ï¸ ATTENZIONE!\n\nEsiste giÃ  un file per ".concat(e,':\n"').concat(d.name,'"\n\nVuoi sovrascriverlo?'),()=>{o.Ay.loading("Aggiornamento file...",{id:"upload"}),c()})}else o.Ay.loading("Caricamento file sul server...",{id:"upload"}),await c()}catch(e){403===(null==e?void 0:e.statusCode)?o.Ay.error("â›” Accesso negato. Solo gli amministratori possono caricare o aggiornare file.",{id:"upload",duration:5e3}):o.Ay.error("âŒ Errore: ".concat(e.message||"Caricamento fallito"),{id:"upload"}),console.error("Upload error:",e)}finally{c(!1),e.target.value=""}}},disabled:l,className:"file-input"}),(0,L.jsx)("label",{htmlFor:"file-upload",className:"upload-label ".concat(l?"uploading":""),children:l?"â³ Caricamento...":"ðŸ“¤ Seleziona File Excel"})]}),(0,L.jsxs)("div",{className:"upload-info",children:[(0,L.jsxs)("p",{children:["Formato file: ",(0,L.jsx)("code",{children:"YYYY.MM.DD Piramis Gara RUSH Inflow Agenti.xlsx"})]}),(0,L.jsx)("p",{children:"File supportati: .xlsx, .xls"}),(0,L.jsxs)("p",{className:"parser-info",children:["ðŸ§  ",(0,L.jsx)("strong",{children:"Parser Dinamico:"})," Si adatta automaticamente alle variazioni tra file diversi"]})]})]}),(0,L.jsxs)("div",{className:"uploaded-files",children:[(0,L.jsxs)("h4",{children:["File Caricati (",n.uploadedFiles.length,")"]}),0===n.uploadedFiles.length?(0,L.jsx)("p",{className:"no-files",children:"Nessun file caricato sul server"}):(0,L.jsx)("div",{className:"files-list",children:n.uploadedFiles.map(e=>(0,L.jsxs)("div",{className:"file-item",children:[(0,L.jsxs)("div",{className:"file-info",children:[(0,L.jsx)("span",{className:"file-name",children:e.name}),e.metadata&&(0,L.jsxs)("div",{className:"file-stats",children:[(0,L.jsxs)("span",{children:[E(e.metadata.totalAgents)," agenti"]}),(0,L.jsxs)("span",{children:[E(e.metadata.totalSMs)," coordinatori"]}),(0,L.jsxs)("span",{children:[z(e.metadata.totalRevenue)," fatturato"]}),(0,L.jsxs)("span",{children:[z(e.metadata.totalRush)," Fatturato Rush"]}),e.metadata.totalFastweb>0&&(0,L.jsxs)("span",{className:"fastweb-badge",children:["âš¡ ",E(e.metadata.totalFastweb)," Fastweb"]})]})]}),(0,L.jsx)("span",{className:"file-date",children:e.displayDate}),(0,L.jsxs)("div",{className:"file-actions",children:[(0,L.jsxs)("span",{className:"file-size",children:[(e.size/1024).toFixed(1)," KB"]}),!d&&(0,L.jsx)("button",{className:"delete-file-btn",onClick:()=>(async(e,a)=>{t("Conferma Eliminazione","Sei sicuro di voler eliminare il file ".concat(a,"?"),async()=>{try{o.Ay.loading("Eliminazione file...",{id:"delete"}),await C.deleteFile(e),o.Ay.success("File eliminato con successo",{id:"delete"}),await i()}catch(e){o.Ay.error("Errore nell'eliminazione: ".concat(e.message),{id:"delete"}),console.error("Delete error:",e)}})})(e.date,e.name),title:"Elimina file",children:"ðŸ—‘ï¸"})]})]},e.id))})]})]})},ca=e=>{let{currentUser:t,onLogout:a,isAuthenticated:n}=e;const[i,r]=(0,s.useState)("dashboard"),[l,o]=(0,s.useState)({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1);(0,s.useEffect)(()=>{const e=()=>{const e=window.innerWidth<768;m(e),e&&p(!0)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.useEffect)(()=>{document.body.classList.toggle("dark-mode",c),c?document.documentElement.style.setProperty("color-scheme","dark"):document.documentElement.style.setProperty("color-scheme","light")},[c]);const x=(e,t,a)=>{o({isOpen:!0,title:e,message:t,onConfirm:()=>{a(),v()}})},v=()=>{o(ta(ta({},l),{},{isOpen:!1}))};return(0,L.jsx)(ia,{isAuthenticated:n,children:(0,L.jsxs)("div",{className:"modern-app-container ".concat(c?"dark":""),children:[(0,L.jsx)(Jt,{activeSection:i,setActiveSection:r,currentUser:t,onLogout:a,isMobile:u,isCollapsed:h,setIsCollapsed:p,isDarkMode:c,setIsDarkMode:d}),(0,L.jsxs)("div",{className:"main-app-area",children:[(0,L.jsx)(Xt,{activeSection:i,isMobile:u,isCollapsed:h,setIsCollapsed:p,currentUser:t,isDarkMode:c}),(0,L.jsx)("main",{className:"modern-main-content ".concat(c?"dark":""),children:(()=>{switch(i){case"dashboard":default:return(0,L.jsx)(Vt,{});case"files":return(0,L.jsx)(oa,{openDialog:x,currentUser:t});case"sm-ranking":return(0,L.jsx)(Ie,{});case"agents":return(0,L.jsx)(Se,{});case"products":return(0,L.jsx)($e,{});case"new-clients":return(0,L.jsx)(ut,{});case"fastweb":return(0,L.jsx)(gt,{});case"historical-analysis":return(0,L.jsx)(Tt,{setActiveSection:r});case"settings":return(0,L.jsx)(_t,{});case"test":return(0,L.jsx)(Lt,{})}})()})]}),(0,L.jsx)(q,{open:l.isOpen,onClose:v,onConfirm:l.onConfirm,title:l.title,message:l.message})]})})},da=function(){const[e,t]=(0,s.useState)(!1),[a,n]=(0,s.useState)(null),[i,c]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{let e=null;if(C.isAuthenticated()){if(e=C.getCurrentUser(),!e){const t=await C.restoreSession();t.success&&(e=t.user)}}else{const t=await C.restoreSession();t.success&&(e=t.user)}if(e){n(e),t(!0);try{await C.healthCheck(),console.log("âœ… Connessione API verificata")}catch(e){console.warn("âš ï¸ Problema connessione API:",e),o.Ay.warning("Connessione al server instabile")}}else n(null),t(!1)}catch(e){console.error("Errore verifica autenticazione:",e)}finally{c(!1)}})()},[]),i?(0,L.jsxs)(r.A,{theme:ra,children:[(0,L.jsx)(l.Ay,{}),(0,L.jsxs)("div",{className:"App",children:[(0,L.jsxs)("div",{className:"loading-container",children:[(0,L.jsx)("div",{className:"loading-spinner"}),(0,L.jsx)("p",{children:"Inizializzazione RUSH Dashboard..."})]}),(0,L.jsx)(o.l$,{position:"top-right"})]})]}):(0,L.jsxs)(r.A,{theme:ra,children:[(0,L.jsx)(l.Ay,{}),(0,L.jsxs)("div",{className:"App",children:[e?(0,L.jsx)(ca,{currentUser:a,onLogout:async()=>{try{await C.logout(),n(null),t(!1),o.Ay.success("Logout effettuato con successo")}catch(e){console.error("Errore durante logout:",e),n(null),t(!1)}},isAuthenticated:e}):(0,L.jsx)(la,{onLogin:e=>{n(e),t(!0)}}),(0,L.jsx)(o.l$,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff",maxWidth:"500px"},success:{duration:3e3,iconTheme:{primary:"#4aed88"}},error:{duration:5e3,iconTheme:{primary:"#ff6b6b"}}}})]})]})};var ua;n.createRoot(document.getElementById("root")).render((0,L.jsx)(s.StrictMode,{children:(0,L.jsx)(da,{})})),ua&&ua instanceof Function&&a.e(364).then(a.bind(a,364)).then(e=>{let{getCLS:t,getFID:a,getFCP:s,getLCP:n,getTTFB:i}=e;t(ua),a(ua),s(ua),n(ua),i(ua)})}},e=>{e.O(0,[137],()=>e(e.s=3320)),e.O()}]);
//# sourceMappingURL=main.2c3cbab77f2b85b46809.js.map